!function(a){function b(a,b,e){return 4===arguments.length?c.apply(this,arguments):void d(a,{declarative:!0,deps:b,declare:e})}function c(a,b,c,e){d(a,{declarative:!1,deps:b,executingRequire:c,execute:e})}function d(a,b){b.name=a,a in o||(o[a]=b),b.normalizedDeps=b.deps}function e(a,b){if(b[a.groupIndex]=b[a.groupIndex]||[],-1==p.call(b[a.groupIndex],a)){b[a.groupIndex].push(a);for(var c=0,d=a.normalizedDeps.length;d>c;c++){var f=a.normalizedDeps[c],g=o[f];if(g&&!g.evaluated){var h=a.groupIndex+(g.declarative!=a.declarative);if(void 0===g.groupIndex||g.groupIndex<h){if(void 0!==g.groupIndex&&(b[g.groupIndex].splice(p.call(b[g.groupIndex],g),1),0==b[g.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");g.groupIndex=h}e(g,b)}}}}function f(a){var b=o[a];b.groupIndex=0;var c=[];e(b,c);for(var d=!!b.declarative==c.length%2,f=c.length-1;f>=0;f--){for(var g=c[f],i=0;i<g.length;i++){var k=g[i];d?h(k):j(k)}d=!d}}function g(a){return t[a]||(t[a]={name:a,dependencies:[],exports:{},importers:[]})}function h(b){if(!b.module){var c=b.module=g(b.name),d=b.module.exports,e=b.declare.call(a,function(a,b){if(c.locked=!0,"object"==typeof a)for(var e in a)d[e]=a[e];else d[a]=b;for(var f=0,g=c.importers.length;g>f;f++){var h=c.importers[f];if(!h.locked)for(var i=0;i<h.dependencies.length;++i)h.dependencies[i]===c&&h.setters[i](d)}return c.locked=!1,b},b.name);c.setters=e.setters,c.execute=e.execute;for(var f=0,i=b.normalizedDeps.length;i>f;f++){var j,k=b.normalizedDeps[f],l=o[k],m=t[k];m?j=m.exports:l&&!l.declarative?j=l.esModule:l?(h(l),m=l.module,j=m.exports):j=n(k),m&&m.importers?(m.importers.push(c),c.dependencies.push(m)):c.dependencies.push(null),c.setters[f]&&c.setters[f](j)}}}function i(a){var b,c=o[a];if(c)c.declarative?m(a,[]):c.evaluated||j(c),b=c.module.exports;else if(b=n(a),!b)throw new Error("Unable to load dependency "+a+".");return(!c||c.declarative)&&b&&b.__useDefault?b["default"]:b}function j(b){if(!b.module){var c={},d=b.module={exports:c,id:b.name};if(!b.executingRequire)for(var e=0,f=b.normalizedDeps.length;f>e;e++){var g=b.normalizedDeps[e],h=o[g];h&&j(h)}b.evaluated=!0;var l=b.execute.call(a,function(a){for(var c=0,d=b.deps.length;d>c;c++)if(b.deps[c]==a)return i(b.normalizedDeps[c]);throw new TypeError("Module "+a+" not declared as a dependency.")},c,d);l&&(d.exports=l),c=d.exports,c&&c.__esModule?b.esModule=c:b.esModule=k(c)}}function k(b){var c={};if(("object"==typeof b||"function"==typeof b)&&b!==a)if(q)for(var d in b)"default"!==d&&l(c,b,d);else{var e=b&&b.hasOwnProperty;for(var d in b)"default"===d||e&&!b.hasOwnProperty(d)||(c[d]=b[d])}return c["default"]=b,s(c,"__useDefault",{value:!0}),c}function l(a,b,c){try{var d;(d=Object.getOwnPropertyDescriptor(b,c))&&s(a,c,d)}catch(e){return a[c]=b[c],!1}}function m(b,c){var d=o[b];if(d&&!d.evaluated&&d.declarative){c.push(b);for(var e=0,f=d.normalizedDeps.length;f>e;e++){var g=d.normalizedDeps[e];-1==p.call(c,g)&&(o[g]?m(g,c):n(g))}d.evaluated||(d.evaluated=!0,d.module.execute.call(a))}}function n(a){if(v[a])return v[a];if("@node/"==a.substr(0,6))return u(a.substr(6));var b=o[a];if(!b)throw"Module "+a+" not present.";return f(a),m(a,[]),o[a]=void 0,b.declarative&&s(b.module.exports,"__esModule",{value:!0}),v[a]=b.declarative?b.module.exports:b.esModule}var o={},p=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},q=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(r){q=!1}var s;!function(){try{Object.defineProperty({},"a",{})&&(s=Object.defineProperty)}catch(a){s=function(a,b,c){try{a[b]=c.value||c.get.call(a)}catch(d){}}}}();var t={},u="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&require.resolve&&"undefined"!=typeof process&&require,v={"@empty":{}};return function(a,d,e,f){return function(g){g(function(g){for(var h={_nodeRequire:u,register:b,registerDynamic:c,get:n,set:function(a,b){v[a]=b},newModule:function(a){return a}},i=0;i<d.length;i++)(function(a,b){b&&b.__esModule?v[a]=b:v[a]=k(b)})(d[i],arguments[i]);f(h);var j=n(a[0]);if(a.length>1)for(var i=1;i<a.length;i++)n(a[i]);return e?j["default"]:j})}}}("undefined"!=typeof self?self:global)(["1"],[],!1,function(a){var b=this.require,c=this.exports,d=this.module;!function(b){function c(a,b){for(var c=a.split(".");c.length;)b=b[c.shift()];return b}function d(a){if("string"==typeof a)return c(a,b);if(!(a instanceof Array))throw new Error("Global exports must be a string or array.");for(var d={},e=!0,f=0;f<a.length;f++){var g=c(a[f],b);e&&(d["default"]=g,e=!1),d[a[f].split(".").pop()]=g}return d}function e(a){if(Object.keys)Object.keys(b).forEach(a);else for(var c in b)i.call(b,c)&&a(c)}function f(a){e(function(c){if(-1==j.call(k,c)){try{var d=b[c]}catch(e){k.push(c)}a(c,d)}})}var g,h=a,i=Object.prototype.hasOwnProperty,j=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},k=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"];h.set("@@global-helpers",h.newModule({prepareGlobal:function(a,c,e){var h=b.define;b.define=void 0;var i;if(e){i={};for(var j in e)i[j]=b[j],b[j]=e[j]}return c||(g={},f(function(a,b){g[a]=b})),function(){var a;if(c)a=d(c);else{a={};var e,j;f(function(b,c){g[b]!==c&&"undefined"!=typeof c&&(a[b]=c,"undefined"!=typeof e?j||e===c||(j=!0):e=c)}),a=j?a:e}if(i)for(var k in i)b[k]=i[k];return b.define=h,a}}}))}("undefined"!=typeof self?self:global),a.register("2",["3","4","5"],function(a,b){"use strict";var c,d,e,f,g;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a.CallbackManager}],execute:function(){f=new e,a("Controller",g=function(){function a(b){c(this,a);var d=this.constructor;this.App=b,this.ready=d.ready}return d(a,[{key:"promise",value:function(a){var b=this;return new Promise(function(c,d){b._resolve=c,b._reject=d,a()})}},{key:"resolve",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return new Promise(function(c){a.dispatchResolved=c,a._resolve(b)}).then(function(){return delete a.dispatchResolved,Promise.resolve()})}},{key:"fail",value:function(a){this._reject(a)}},{key:"exec",value:function(){var a=this;return this.promise(function(){a.resolve()})}},{key:"redirect",value:function(a){this.App.navigate(a)}}]),a}()),a("Controller",g),g.ready=Promise.resolve(),f.attachToPrototype(g.prototype)}}}),a.register("6",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("ScriptHelper",e=function(){function a(){c(this,a)}return d(a,null,[{key:"addByUrl",value:function(a){return new Promise(function(b,c){var d=document.createElement("script");d.type="text/javascript",d.src=a,d.addEventListener("load",function(){b(d)}),d.addEventListener("error",function(){c(d)}),d.addEventListener("abort",function(){c(d)}),document.body.appendChild(d)})}}]),a}()),a("ScriptHelper",e)}}}),a.register("7",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function b(a,c,d){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,c);if(void 0===e){var f=Object.getPrototypeOf(a);return null===f?void 0:b(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)})}}}),a.register("8",["3","4","9","a","b","c"],function(a,b){"use strict";var c,d,e,f,g,h,i;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a.Ajax},function(a){h=a.Model}],execute:function(){a("AjaxModel",i=function(a){function b(){return c(this,b),e(this,Object.getPrototypeOf(b).apply(this,arguments))}return f(b,a),d(b,[{key:"beforeFetch",value:function(){return Promise.resolve()}},{key:"afterFetch",value:function(a){return Promise.resolve(a)}},{key:"fetch",value:function(){for(var a=this,b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];var e=this.constructor;return e.ready.then(function(){return a.beforeFetch.apply(a,c).then(function(){return a.endpoint?g.get(""+a.endpoint,a.fetchOptions).then(function(a){return Promise.resolve(a)},function(a){return a&&0===a.status&&"undefined"!=typeof a.response&&null!==a.response?Promise.resolve(a.response):Promise.reject(a)}).then(function(b){return a.afterFetch(b).then(function(b){return a.set(b),Promise.resolve(b)})}):Promise.reject()})})}},{key:"fetchOptions",get:function(){return{}}}]),b}(h)),a("AjaxModel",i)}}}),a.registerDynamic("d",[],!1,function(e,f,g){var h=a.get("@@global-helpers").prepareGlobal(g.id,"PouchDB",null);return function(){!function(a){if("object"==typeof c&&"undefined"!=typeof d)d.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.PouchDB=a()}}(function(){var a;return function c(a,d,e){function f(h,i){if(!d[h]){if(!a[h]){var j="function"==typeof b&&b;if(!i&&j)return j(h,!0);if(g)return g(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var l=d[h]={exports:{}};a[h][0].call(l.exports,function(b){var c=a[h][1][b];return f(c?c:b)},l,l.exports,c,a,d,e)}return d[h].exports}for(var g="function"==typeof b&&b,h=0;h<e.length;h++)f(e[h]);return f}({1:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}},{}],2:[function(a,b,c){function d(){k&&h&&(k=!1,h.length?j=h.concat(j):l=-1,j.length&&e())}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],3:[function(a,b,c){(function(c,d){"use strict";function e(a){return a&&"object"==typeof a&&"default"in a?a["default"]:a}function f(a){return a instanceof ArrayBuffer||"undefined"!=typeof Blob&&a instanceof Blob}function g(a){if("function"==typeof a.slice)return a.slice(0);var b=new ArrayBuffer(a.byteLength),c=new Uint8Array(b),d=new Uint8Array(a);return c.set(d),b}function h(a){if(a instanceof ArrayBuffer)return g(a);var b=a.size,c=a.type;return"function"==typeof a.slice?a.slice(0,b,c):a.webkitSlice(0,b,c)}function i(a){var b=Object.getPrototypeOf(a);if(null===b)return!0;var c=b.constructor;return"function"==typeof c&&c instanceof c&&zd.call(c)==Ad}function j(a){var b,c,d;if(!a||"object"!=typeof a)return a;if(Array.isArray(a)){for(b=[],c=0,d=a.length;d>c;c++)b[c]=j(a[c]);return b}if(a instanceof Date)return a.toISOString();if(f(a))return h(a);if(!i(a))return a;b={};for(c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var e=j(a[c]);"undefined"!=typeof e&&(b[c]=e)}return b}function k(a){var b=!1;return sd(function(c){if(b)throw new Error("once called more than once");b=!0,a.apply(this,c)})}function l(a){return sd(function(b){b=j(b);var d,e=this,f="function"==typeof b[b.length-1]?b.pop():!1;f&&(d=function(a,b){c.nextTick(function(){f(a,b)})});var g=new yd(function(c,d){var f;try{var g=k(function(a,b){a?d(a):c(b)});b.push(g),f=a.apply(e,b),f&&"function"==typeof f.then&&c(f)}catch(h){d(h)}});return d&&g.then(function(a){d(null,a)},d),g})}function m(a,b){function c(a,b,c){if(Bd.enabled){for(var d=[a._db_name,b],e=0;e<c.length-1;e++)d.push(c[e]);Bd.apply(null,d);var f=c[c.length-1];c[c.length-1]=function(c,d){var e=[a._db_name,b];e=e.concat(c?["error",c]:["success",d]),Bd.apply(null,e),f(c,d)}}}return l(sd(function(d){if(this._closed)return yd.reject(new Error("database is closed"));if(this._destroyed)return yd.reject(new Error("database is destroyed"));var e=this;return c(e,a,d),this.taskqueue.isReady?b.apply(this,d):new yd(function(b,c){e.taskqueue.addTask(function(f){f?c(f):b(e[a].apply(e,d))})})}))}function n(a,b){for(var c={},d=0,e=b.length;e>d;d++){var f=b[d];f in a&&(c[f]=a[f])}return c}function o(a){return a}function p(a){return[{ok:a}]}function q(a,b,c){function d(){var a=[];m.forEach(function(b){b.docs.forEach(function(c){a.push({id:b.id,docs:[c]})})}),c(null,{results:a})}function e(){++l===k&&d()}function f(a,b,c){m[a]={id:b,docs:c},e()}function g(){if(!(r>=q.length)){var a=Math.min(r+Cd,q.length),b=q.slice(r,a);h(b,r),r+=b.length}}function h(c,d){c.forEach(function(c,e){var h=d+e,i=j[c],k=n(i[0],["atts_since","attachments"]);k.open_revs=i.map(function(a){return a.rev}),k.open_revs=k.open_revs.filter(o);var l=o;0===k.open_revs.length&&(delete k.open_revs,l=p),["revs","attachments","binary","ajax"].forEach(function(a){a in b&&(k[a]=b[a])}),a.get(c,k,function(a,b){var d;d=a?[{error:a}]:l(b),f(h,c,d),g()})})}var i=b.docs,j={};i.forEach(function(a){a.id in j?j[a.id].push(a):j[a.id]=[a]});var k=Object.keys(j).length,l=0,m=new Array(k),q=Object.keys(j),r=0;g()}function r(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function s(){return md}function t(a){r()?chrome.storage.onChanged.addListener(function(b){null!=b.db_name&&a.emit(b.dbName.newValue)}):s()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(b){a.emit(b.key)}):window.attachEvent("storage",function(b){a.emit(b.key)}))}function u(){td.EventEmitter.call(this),this._listeners={},t(this)}function v(a){if("undefined"!==console&&a in console){var b=Array.prototype.slice.call(arguments,1);console[a].apply(console,b)}}function w(a,b){var c=6e5;a=parseInt(a,10)||0,b=parseInt(b,10),b!==b||a>=b?b=(a||1)<<1:b+=1,b>c&&(a=c>>1,b=c);var d=Math.random(),e=b-a;return~~(e*d+a)}function x(a){var b=0;return a||(b=2e3),w(a,b)}function y(a,b){v("info","The above "+a+" is totally normal. "+b)}function z(a){Error.call(this,a.reason),this.status=a.status,this.name=a.error,this.message=a.reason,this.error=!0}function A(a,b,c){function d(b){for(var d in a)"function"!=typeof a[d]&&(this[d]=a[d]);void 0!==c&&(this.name=c),void 0!==b&&(this.reason=b)}return d.prototype=z.prototype,new d(b)}function B(a){var b,c,d,e,f;return c=a.error===!0&&"string"==typeof a.name?a.name:a.error,f=a.reason,d=be("name",c,f),a.missing||"missing"===f||"deleted"===f||"not_found"===c?d=Gd:"doc_validation"===c?(d=Qd,e=f):"bad_request"===c&&d.message!==f&&(d=Rd),d||(d=be("status",a.status,f)||Md),b=A(d,f,c),e&&(b.message=e),a.id&&(b.id=a.id),a.status&&(b.status=a.status),a.missing&&(b.missing=a.missing),b}function C(a,b,c){try{return!a(b,c)}catch(d){var e="Filter function threw: "+d.toString();return A(Rd,e)}}function D(a){var b={},c=a.filter&&"function"==typeof a.filter;return b.query=a.query_params,function(d){d.doc||(d.doc={});var e=c&&C(a.filter,d.doc,b);if("object"==typeof e)return e;if(e)return!1;if(a.include_docs){if(!a.attachments)for(var f in d.doc._attachments)d.doc._attachments.hasOwnProperty(f)&&(d.doc._attachments[f].stub=!0)}else delete d.doc;return!0}}function E(a){for(var b=[],c=0,d=a.length;d>c;c++)b=b.concat(a[c]);return b}function F(a){var b;if(a?"string"!=typeof a?b=A(Id):/^_/.test(a)&&!/^_(design|local)/.test(a)&&(b=A(Kd)):b=A(Jd),b)throw b}function G(a,b){return"listenerCount"in a?a.listenerCount(b):td.EventEmitter.listenerCount(a,b)}function H(a){if(!a)return null;var b=a.split("/");return 2===b.length?b:1===b.length?[a,a]:null}function I(a){var b=H(a);return b?b.join("/"):null}function J(a){for(var b=fe.exec(a),c={},d=14;d--;){var e=ce[d],f=b[d]||"",g=-1!==["user","password"].indexOf(e);c[e]=g?decodeURIComponent(f):f}return c[de]={},c[ce[12]].replace(ee,function(a,b,d){b&&(c[de][b]=d)}),c}function K(a,b,c){return new yd(function(d,e){a.get(b,function(f,g){if(f){if(404!==f.status)return e(f);g={}}var h=g._rev,i=c(g);return i?(i._id=b,i._rev=h,void d(L(a,i,c))):d({updated:!1,rev:h})})})}function L(a,b,c){return a.put(b).then(function(a){return{updated:!0,rev:a.rev}},function(d){if(409!==d.status)throw d;return K(a,b._id,c)})}function M(a){return 0|Math.random()*a}function N(a,b){b=b||ge.length;var c="",d=-1;if(a){for(;++d<a;)c+=ge[M(b)];return c}for(;++d<36;)switch(d){case 8:case 13:case 18:case 23:c+="-";break;case 19:c+=ge[3&M(16)|8];break;default:c+=ge[M(16)]}return c}function O(a){for(var b,c,d,e,f=a.rev_tree.slice();e=f.pop();){var g=e.ids,h=g[2],i=e.pos;if(h.length)for(var j=0,k=h.length;k>j;j++)f.push({pos:i+1,ids:h[j]});else{var l=!!g[1].deleted,m=g[0];b&&!(d!==l?d:c!==i?i>c:m>b)||(b=m,c=i,d=l)}}return c+"-"+b}function P(a,b){for(var c,d=a.slice();c=d.pop();)for(var e=c.pos,f=c.ids,g=f[2],h=b(0===g.length,e,f[0],c.ctx,f[1]),i=0,j=g.length;j>i;i++)d.push({pos:e+1,ids:g[i],ctx:h})}function Q(a,b){return a.pos-b.pos}function R(a){var b=[];P(a,function(a,c,d,e,f){a&&b.push({rev:c+"-"+d,pos:c,opts:f})}),b.sort(Q).reverse();for(var c=0,d=b.length;d>c;c++)delete b[c].pos;return b}function S(a){for(var b=O(a),c=R(a.rev_tree),d=[],e=0,f=c.length;f>e;e++){var g=c[e];g.rev===b||g.opts.deleted||d.push(g.rev)}return d}function T(a){var b=[];return P(a.rev_tree,function(a,c,d,e,f){"available"!==f.status||a||(b.push(c+"-"+d),f.status="missing")}),b}function U(a){for(var b,c=[],d=a.slice();b=d.pop();){var e=b.pos,f=b.ids,g=f[0],h=f[1],i=f[2],j=0===i.length,k=b.history?b.history.slice():[];k.push({id:g,opts:h}),j&&c.push({pos:e+1-k.length,ids:k});for(var l=0,m=i.length;m>l;l++)d.push({pos:e+1,ids:i[l],history:k})}return c.reverse()}function V(a,b){return a.pos-b.pos}function W(a,b,c){for(var d,e=0,f=a.length;f>e;)d=e+f>>>1,c(a[d],b)<0?e=d+1:f=d;return e}function X(a,b,c){var d=W(a,b,c);a.splice(d,0,b)}function Y(a,b){for(var c,d,e=b,f=a.length;f>e;e++){var g=a[e],h=[g.id,g.opts,[]];d?(d[2].push(h),d=h):c=d=h}return c}function Z(a,b){return a[0]<b[0]?-1:1}function $(a,b){for(var c=[{tree1:a,tree2:b}],d=!1;c.length>0;){var e=c.pop(),f=e.tree1,g=e.tree2;(f[1].status||g[1].status)&&(f[1].status="available"===f[1].status||"available"===g[1].status?"available":"missing");for(var h=0;h<g[2].length;h++)if(f[2][0]){for(var i=!1,j=0;j<f[2].length;j++)f[2][j][0]===g[2][h][0]&&(c.push({tree1:f[2][j],tree2:g[2][h]}),i=!0);i||(d="new_branch",X(f[2],g[2][h],Z))}else d="new_leaf",f[2][0]=g[2][h]}return{conflicts:d,tree:a}}function _(a,b,c){var d,e=[],f=!1,g=!1;if(!a.length)return{tree:[b],conflicts:"new_leaf"};for(var h=0,i=a.length;i>h;h++){var j=a[h];if(j.pos===b.pos&&j.ids[0]===b.ids[0])d=$(j.ids,b.ids),e.push({pos:j.pos,ids:d.tree}),f=f||d.conflicts,g=!0;else if(c!==!0){var k=j.pos<b.pos?j:b,l=j.pos<b.pos?b:j,m=l.pos-k.pos,n=[],o=[];for(o.push({ids:k.ids,diff:m,parent:null,parentIdx:null});o.length>0;){var p=o.pop();if(0!==p.diff)for(var q=p.ids[2],r=0,s=q.length;s>r;r++)o.push({ids:q[r],diff:p.diff-1,parent:p.ids,parentIdx:r});else p.ids[0]===l.ids[0]&&n.push(p)}var t=n[0];t?(d=$(t.ids,l.ids),t.parent[2][t.parentIdx]=d.tree,e.push({pos:k.pos,ids:k.ids}),f=f||d.conflicts,g=!0):e.push(j)}else e.push(j)}return g||e.push(b),e.sort(V),{tree:e,conflicts:f||"internal_node"}}function aa(a,b){for(var c,d=U(a),e={},f=0,g=d.length;g>f;f++){for(var h=d[f],i=h.ids,j=Math.max(0,i.length-b),k={pos:h.pos+j,ids:Y(i,j)},l=0;j>l;l++){var m=h.pos+l+"-"+i[l].id;e[m]=!0}c=c?_(c,k,!0).tree:[k]}return P(c,function(a,b,c){delete e[b+"-"+c]}),{tree:c,revs:Object.keys(e)}}function ba(a,b,c){var d=_(a,b),e=aa(d.tree,c);return{tree:e.tree,stemmedRevs:e.revs,conflicts:d.conflicts}}function ca(a,b){for(var c,d=a.slice(),e=b.split("-"),f=parseInt(e[0],10),g=e[1];c=d.pop();){if(c.pos===f&&c.ids[0]===g)return!0;for(var h=c.ids[2],i=0,j=h.length;j>i;i++)d.push({pos:c.pos+1,ids:h[i]})}return!1}function da(a){return a.ids}function ea(a,b){b||(b=O(a));for(var c,d=b.substring(b.indexOf("-")+1),e=a.rev_tree.map(da);c=e.pop();){if(c[0]===d)return!!c[1].deleted;e=e.concat(c[2])}}function fa(a){return/^_local/.test(a)}function ga(a){return ud("return "+a+";",{})}function ha(a){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+a+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function ia(a,b){try{a.emit("change",b)}catch(c){v("error",'Error in .on("change", function):',c)}}function ja(a,b,c){function d(){e.cancel()}td.EventEmitter.call(this);var e=this;this.db=a,b=b?j(b):{};var f=b.complete=k(function(b,c){b?G(e,"error")>0&&e.emit("error",b):e.emit("complete",c),e.removeAllListeners(),a.removeListener("destroyed",d)});c&&(e.on("complete",function(a){c(null,a)}),e.on("error",c)),a.once("destroyed",d),b.onChange=function(a){b.isCancelled||(ia(e,a),e.startSeq&&e.startSeq<=a.seq&&(e.startSeq=!1))};var g=new yd(function(a,c){b.complete=function(b,d){b?c(b):a(d)}});e.once("cancel",function(){a.removeListener("destroyed",d),b.complete(null,{status:"cancelled"})}),this.then=g.then.bind(g),this["catch"]=g["catch"].bind(g),this.then(function(a){f(null,a)},f),a.taskqueue.isReady?e.doChanges(b):a.taskqueue.addTask(function(){e.isCancelled?e.emit("cancel"):e.doChanges(b)})}function ka(a,b,c){var d=[{rev:a._rev}];"all_docs"===c.style&&(d=R(b.rev_tree).map(function(a){return{rev:a.rev}}));var e={id:b.id,changes:d,doc:a};return ea(b,a._rev)&&(e.deleted=!0),c.conflicts&&(e.doc._conflicts=S(b),e.doc._conflicts.length||delete e.doc._conflicts),e}function la(a,b){return b>a?-1:a>b?1:0}function ma(a,b){for(var c=0;c<a.length;c++)if(b(a[c],c)===!0)return a[c]}function na(a){return function(b,c){b||c[0]&&c[0].error?a(b||c[0]):a(null,c.length?c[0]:c)}}function oa(a){for(var b=0;b<a.length;b++){var c=a[b];if(c._deleted)delete c._attachments;else if(c._attachments)for(var d=Object.keys(c._attachments),e=0;e<d.length;e++){var f=d[e];c._attachments[f]=n(c._attachments[f],["data","digest","content_type","length","revpos","stub"])}}}function pa(a,b){var c=la(a._id,b._id);if(0!==c)return c;var d=a._revisions?a._revisions.start:0,e=b._revisions?b._revisions.start:0;return la(d,e)}function qa(a){var b={},c=[];return P(a,function(a,d,e,f){var g=d+"-"+e;return a&&(b[g]=0),void 0!==f&&c.push({from:f,to:g}),g}),c.reverse(),c.forEach(function(a){void 0===b[a.from]?b[a.from]=1+b[a.to]:b[a.from]=Math.min(b[a.from],1+b[a.to])}),b}function ra(a,b,c){var d="limit"in b?b.keys.slice(b.skip,b.limit+b.skip):b.skip>0?b.keys.slice(b.skip):b.keys;if(b.descending&&d.reverse(),!d.length)return a._allDocs({limit:0},c);var e={offset:b.skip};return yd.all(d.map(function(c){var d=nd.extend({key:c,deleted:"ok"},b);return["limit","skip","keys"].forEach(function(a){delete d[a]}),new yd(function(b,f){a._allDocs(d,function(a,d){return a?f(a):(e.total_rows=d.total_rows,void b(d.rows[0]||{key:c,error:"not_found"}))})})})).then(function(a){return e.rows=a,e})}function sa(a){var b=a._compactionQueue[0],d=b.opts,e=b.callback;a.get("_local/compaction")["catch"](function(){return!1}).then(function(b){b&&b.last_seq&&(d.last_seq=b.last_seq),a._compact(d,function(b,d){b?e(b):e(null,d),c.nextTick(function(){a._compactionQueue.shift(),a._compactionQueue.length&&sa(a)})})})}function ta(a){return"_"===a.charAt(0)?a+"is not a valid attachment name, attachment names cannot start with '_'":!1}function ua(){td.EventEmitter.call(this)}function va(){this.isReady=!1,this.failed=!1,this.queue=[]}function wa(a){a&&d.debug&&v("error",a)}function xa(a,b){function c(){f.emit("destroyed",e)}function d(){a.removeListener("destroyed",c),a.emit("destroyed",a)}var e=b.originalName,f=a.constructor,g=f._destructionListeners;a.once("destroyed",c),g.has(e)||g.set(e,[]),g.get(e).push(d)}function ya(a,b,c){if(!(this instanceof ya))return new ya(a,b,c);var d=this;if("function"!=typeof b&&"undefined"!=typeof b||(c=b,b={}),a&&"object"==typeof a&&(b=a,a=void 0),"undefined"==typeof c)c=wa;else{var e=c;c=function(){return v("warn","Using a callback for new PouchDB()is deprecated."),e.apply(null,arguments)}}a=a||b.name,b=j(b),delete b.name,this.__opts=b;var f=c;d.auto_compaction=b.auto_compaction,d.prefix=ya.prefix,ua.call(d),d.taskqueue=new va;var g=new yd(function(e,f){c=function(a,b){return a?f(a):(delete b.then,void e(b))},b=j(b);var g,h;return function(){try{if("string"!=typeof a)throw h=new Error("Missing/invalid DB name"),h.code=400,h;var c=(b.prefix||"")+a;if(g=ya.parseAdapter(c,b),b.originalName=a,b.name=g.name,b.adapter=b.adapter||g.adapter,d._adapter=b.adapter,od("pouchdb:adapter")("Picked adapter: "+b.adapter),d._db_name=a,!ya.adapters[b.adapter])throw h=new Error("Adapter is missing"),h.code=404,h;if(!ya.adapters[b.adapter].valid())throw h=new Error("Invalid Adapter"),h.code=404,h}catch(e){d.taskqueue.fail(e)}}(),h?f(h):(d.adapter=b.adapter,d.replicate={},d.replicate.from=function(a,b,c){return d.constructor.replicate(a,d,b,c)},d.replicate.to=function(a,b,c){return d.constructor.replicate(d,a,b,c)},d.sync=function(a,b,c){return d.constructor.sync(d,a,b,c)},d.replicate.sync=d.sync,void ya.adapters[b.adapter].call(d,b,function(a){return a?(d.taskqueue.fail(a),void c(a)):(xa(d,b),d.emit("created",d),ya.emit("created",b.originalName),d.taskqueue.ready(d),void c(null,d))}))});g.then(function(a){f(null,a)},f),d.then=g.then.bind(g),d["catch"]=g["catch"].bind(g)}function za(a){Object.keys(td.EventEmitter.prototype).forEach(function(b){"function"==typeof td.EventEmitter.prototype[b]&&(a[b]=he[b].bind(he))});var b=a._destructionListeners=new rd.Map;a.on("destroyed",function(a){b.get(a).forEach(function(a){a()}),b["delete"](a)})}function Aa(a){return a.reduce(function(a,b){return a[b]=!0,a},{})}function Ba(a){if(!/^\d+\-./.test(a))return A(Yd);var b=a.indexOf("-"),c=a.substring(0,b),d=a.substring(b+1);return{prefix:parseInt(c,10),id:d}}function Ca(a,b){for(var c=a.start-a.ids.length+1,d=a.ids,e=[d[0],b,[]],f=1,g=d.length;g>f;f++)e=[d[f],{status:"missing"},[e]];return[{pos:c,ids:e}]}function Da(a,b){var c,d,e,f={status:"available"};if(a._deleted&&(f.deleted=!0),b)if(a._id||(a._id=N()),d=N(32,16).toLowerCase(),a._rev){if(e=Ba(a._rev),e.error)return e;a._rev_tree=[{pos:e.prefix,ids:[e.id,{status:"missing"},[[d,f,[]]]]}],c=e.prefix+1}else a._rev_tree=[{pos:1,ids:[d,f,[]]}],c=1;else if(a._revisions&&(a._rev_tree=Ca(a._revisions,f),c=a._revisions.start,d=a._revisions.ids[0]),!a._rev_tree){if(e=Ba(a._rev),e.error)return e;c=e.prefix,d=e.id,a._rev_tree=[{pos:c,ids:[d,f,[]]}]}F(a._id),a._rev=c+"-"+d;var g={metadata:{},data:{}};for(var h in a)if(Object.prototype.hasOwnProperty.call(a,h)){var i="_"===h[0];if(i&&!ke[h]){var j=A(Qd,h);throw j.message=Qd.message+": "+h,j}i&&!le[h]?g.metadata[h.slice(1)]=a[h]:g.data[h]=a[h]}return g}function Ea(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return b}function Fa(a){return ne(Ea(a))}function Ga(a,b){a=a||[],b=b||{};try{return new Blob(a,b)}catch(c){if("TypeError"!==c.name)throw c;for(var d="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,e=new d,f=0;f<a.length;f+=1)e.append(a[f]);return e.getBlob(b.type)}}function Ha(a){for(var b=a.length,c=new ArrayBuffer(b),d=new Uint8Array(c),e=0;b>e;e++)d[e]=a.charCodeAt(e);return c}function Ia(a,b){return Ga([Ha(a)],{type:b})}function Ja(a,b){return Ia(me(a),b)}function Ka(a,b){if("undefined"==typeof FileReader)return b(Ea((new FileReaderSync).readAsArrayBuffer(a)));var c=new FileReader,d="function"==typeof c.readAsBinaryString;c.onloadend=function(a){var c=a.target.result||"";return d?b(c):void b(Ea(c))},d?c.readAsBinaryString(a):c.readAsArrayBuffer(a)}function La(a,b){Ka(a,function(a){b(ne(a))})}function Ma(a,b){if("undefined"==typeof FileReader)return b((new FileReaderSync).readAsArrayBuffer(a));var c=new FileReader;c.onloadend=function(a){var c=a.target.result||new ArrayBuffer(0);b(c)},c.readAsArrayBuffer(a)}function Na(a){return ne(a)}function Oa(a,b,c,d){(c>0||d<b.byteLength)&&(b=new Uint8Array(b,c,Math.min(d,b.byteLength)-c)),a.append(b)}function Pa(a,b,c,d){(c>0||d<b.length)&&(b=b.substring(c,d)),a.appendBinary(b)}function Qa(a,b){function c(){var d=h*f,e=d+f;if(h++,g>h)j(i,a,d,e),oe(c);else{j(i,a,d,e);var k=i.end(!0),l=Na(k);b(l),i.destroy()}}var d="string"==typeof a,e=d?a.length:a.byteLength,f=Math.min(pe,e),g=Math.ceil(e/f),h=0,i=d?new vd:new vd.ArrayBuffer,j=d?Pa:Oa;
c()}function Ra(a){return vd.hash(a)}function Sa(a,b,c){function d(a){try{return me(a)}catch(b){var c=A(Nd,"Attachment is not a valid base64 string");return{error:c}}}function e(a,c){if(a.stub)return c();if("string"==typeof a.data){var e=d(a.data);if(e.error)return c(e.error);a.length=e.length,"blob"===b?a.data=Ia(e,a.content_type):"base64"===b?a.data=ne(e):a.data=e,Qa(e,function(b){a.digest="md5-"+b,c()})}else Ma(a.data,function(d){"binary"===b?a.data=Ea(d):"base64"===b&&(a.data=Fa(d)),Qa(d,function(b){a.digest="md5-"+b,a.length=d.byteLength,c()})})}function f(){h++,a.length===h&&(g?c(g):c())}if(!a.length)return c();var g,h=0;a.forEach(function(a){function b(a){g=a,d++,d===c.length&&f()}var c=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],d=0;if(!c.length)return f();for(var h in a.data._attachments)a.data._attachments.hasOwnProperty(h)&&e(a.data._attachments[h],b)})}function Ta(a,b,c,d,e,f,g,h){if(ca(b.rev_tree,c.metadata.rev))return d[e]=c,f();var i=b.winningRev||O(b),j="deleted"in b?b.deleted:ea(b,i),k="deleted"in c.metadata?c.metadata.deleted:ea(c.metadata),l=/^1-/.test(c.metadata.rev);if(j&&!k&&h&&l){var m=c.data;m._rev=i,m._id=c.metadata.id,c=Da(m,h)}var n=ba(b.rev_tree,c.metadata.rev_tree[0],a),o=h&&(j&&k||!j&&"new_leaf"!==n.conflicts||j&&!k&&"new_branch"===n.conflicts);if(o){var p=A(Hd);return d[e]=p,f()}var q=c.metadata.rev;c.metadata.rev_tree=n.tree,c.stemmedRevs=n.stemmedRevs||[],b.rev_map&&(c.metadata.rev_map=b.rev_map);var r,s=O(c.metadata),t=ea(c.metadata,s),u=j===t?0:t>j?-1:1;r=q===s?t:ea(c.metadata,q),g(c,s,t,r,!0,u,e,f)}function Ua(a){return"missing"===a.metadata.rev_tree[0].ids[1].status}function Va(a,b,c,d,e,f,g,h,i){function j(a,b,c){var d=O(a.metadata),e=ea(a.metadata,d);if("was_delete"in h&&e)return f[b]=A(Gd,"deleted"),c();var i=l&&Ua(a);if(i){var j=A(Hd);return f[b]=j,c()}var k=e?0:1;g(a,d,e,e,!1,k,b,c)}function k(){++n===o&&i&&i()}a=a||1e3;var l=h.new_edits,m=new rd.Map,n=0,o=b.length;b.forEach(function(a,b){if(a._id&&fa(a._id)){var d=a._deleted?"_removeLocal":"_putLocal";return void c[d](a,{ctx:e},function(a,c){f[b]=a||c,k()})}var g=a.metadata.id;m.has(g)?(o--,m.get(g).push([a,b])):m.set(g,[[a,b]])}),m.forEach(function(b,c){function e(){++i<b.length?h():k()}function h(){var h=b[i],k=h[0],m=h[1];if(d.has(c))Ta(a,d.get(c),k,f,m,e,g,l);else{var n=ba([],k.metadata.rev_tree[0],a);k.metadata.rev_tree=n.tree,k.stemmedRevs=n.stemmedRevs||[],j(k,m,e)}}var i=0;h()})}function Wa(a){try{return JSON.parse(a)}catch(b){return wd.parse(a)}}function Xa(a){return a.length<5e4?JSON.parse(a):Wa(a)}function Ya(a){try{return JSON.stringify(a)}catch(b){return wd.stringify(a)}}function Za(a,b,c,d){try{a.apply(b,c)}catch(e){d.emit("error",e)}}function $a(a){if(!ye.running&&ye.queue.length){ye.running=!0;var b=ye.queue.shift();b.action(function(d,e){Za(b.callback,this,[d,e],a),ye.running=!1,c.nextTick(function(){$a(a)})})}}function _a(a){return function(b){var c="unknown_error";b.target&&b.target.error&&(c=b.target.error.name||b.target.error.message),a(A(Ud,c,b.type))}}function ab(a,b,c){return{data:Ya(a),winningRev:b,deletedOrLocal:c?"1":"0",seq:a.seq,id:a.id}}function bb(a){if(!a)return null;var b=Xa(a.data);return b.winningRev=a.winningRev,b.deleted="1"===a.deletedOrLocal,b.seq=a.seq,b}function cb(a){if(!a)return a;var b=a._doc_id_rev.lastIndexOf(":");return a._id=a._doc_id_rev.substring(0,b-1),a._rev=a._doc_id_rev.substring(b+1),delete a._doc_id_rev,a}function db(a,b,c,d){c?d(a?"string"!=typeof a?a:Ja(a,b):Ga([""],{type:b})):a?"string"!=typeof a?Ka(a,function(a){d(ne(a))}):d(a):d("")}function eb(a,b,c,d){function e(){++h===g.length&&d&&d()}function f(a,b){var d=a._attachments[b],f=d.digest,g=c.objectStore(te).get(f);g.onsuccess=function(a){d.body=a.target.result.body,e()}}var g=Object.keys(a._attachments||{});if(!g.length)return d&&d();var h=0;g.forEach(function(c){b.attachments&&b.include_docs?f(a,c):(a._attachments[c].stub=!0,e())})}function fb(a,b){return yd.all(a.map(function(a){if(a.doc&&a.doc._attachments){var c=Object.keys(a.doc._attachments);return yd.all(c.map(function(c){var d=a.doc._attachments[c];if("body"in d){var e=d.body,f=d.content_type;return new yd(function(g){db(e,f,b,function(b){a.doc._attachments[c]=nd.extend(n(d,["digest","content_type"]),{data:b}),g()})})}}))}}))}function gb(a,b,c){function d(){j--,j||e()}function e(){f.length&&f.forEach(function(a){var b=i.index("digestSeq").count(IDBKeyRange.bound(a+"::",a+"::￿",!1,!1));b.onsuccess=function(b){var c=b.target.result;c||h["delete"](a)}})}var f=[],g=c.objectStore(se),h=c.objectStore(te),i=c.objectStore(ue),j=a.length;a.forEach(function(a){var c=g.index("_doc_id_rev"),e=b+"::"+a;c.getKey(e).onsuccess=function(a){var b=a.target.result;if("number"!=typeof b)return d();g["delete"](b);var c=i.index("seq").openCursor(IDBKeyRange.only(b));c.onsuccess=function(a){var b=a.target.result;if(b){var c=b.value.digestSeq.split("::")[0];f.push(c),i["delete"](b.primaryKey),b["continue"]()}else d()}}})}function hb(a,b,c){try{return{txn:a.transaction(b,c)}}catch(d){return{error:d}}}function ib(a,b,c,d,e,f,g){function h(){var a=[re,se,te,we,ue],b=hb(e,a,"readwrite");return b.error?g(b.error):(s=b.txn,s.onabort=_a(g),s.ontimeout=_a(g),s.oncomplete=k,t=s.objectStore(re),u=s.objectStore(se),v=s.objectStore(te),w=s.objectStore(ue),void m(function(a){return a?(G=!0,g(a)):void j()}))}function i(){Va(a.revs_limit,y,d,F,s,E,n,c)}function j(){function a(){++c===y.length&&i()}function b(b){var c=bb(b.target.result);c&&F.set(c.id,c),a()}if(y.length)for(var c=0,d=0,e=y.length;e>d;d++){var f=y[d];if(f._id&&fa(f._id))a();else{var g=t.get(f.metadata.id);g.onsuccess=b}}}function k(){G||(f.notify(d._meta.name),d._meta.docCount+=z,g(null,E))}function l(a,b){var c=v.get(a);c.onsuccess=function(c){if(c.target.result)b();else{var d=A($d,"unknown stub attachment with digest "+a);d.status=412,b(d)}}}function m(a){function b(){++e===c.length&&a(d)}var c=[];if(y.forEach(function(a){a.data&&a.data._attachments&&Object.keys(a.data._attachments).forEach(function(b){var d=a.data._attachments[b];d.stub&&c.push(d.digest)})}),!c.length)return a();var d,e=0;c.forEach(function(a){l(a,function(a){a&&!d&&(d=a),b()})})}function n(a,b,c,d,e,f,g,h){z+=f,a.metadata.winningRev=b,a.metadata.deleted=c;var i=a.data;i._id=a.metadata.id,i._rev=a.metadata.rev,d&&(i._deleted=!0);var j=i._attachments&&Object.keys(i._attachments).length;return j?p(a,b,c,e,g,h):void o(a,b,c,e,g,h)}function o(a,b,c,e,f,g){function h(f){var g=a.stemmedRevs||[];e&&d.auto_compaction&&(g=g.concat(T(a.metadata))),g&&g.length&&gb(g,a.metadata.id,s),l.seq=f.target.result,delete l.rev;var h=ab(l,b,c),i=t.put(h);i.onsuccess=j}function i(a){a.preventDefault(),a.stopPropagation();var b=u.index("_doc_id_rev"),c=b.getKey(k._doc_id_rev);c.onsuccess=function(a){var b=u.put(k,a.target.result);b.onsuccess=h}}function j(){E[f]={ok:!0,id:l.id,rev:b},F.set(a.metadata.id,a.metadata),q(a,l.seq,g)}var k=a.data,l=a.metadata;k._doc_id_rev=l.id+"::"+l.rev,delete k._id,delete k._rev;var m=u.put(k);m.onsuccess=h,m.onerror=i}function p(a,b,c,d,e,f){function g(){j===k.length&&o(a,b,c,d,e,f)}function h(){j++,g()}var i=a.data,j=0,k=Object.keys(i._attachments);k.forEach(function(c){var d=a.data._attachments[c];if(d.stub)j++,g();else{var e=d.data;delete d.data,d.revpos=parseInt(b,10);var f=d.digest;r(f,e,h)}})}function q(a,b,c){function d(){++f===g.length&&c()}function e(c){var e=a.data._attachments[c].digest,f=w.put({seq:b,digestSeq:e+"::"+b});f.onsuccess=d,f.onerror=function(a){a.preventDefault(),a.stopPropagation(),d()}}var f=0,g=Object.keys(a.data._attachments||{});if(!g.length)return c();for(var h=0;h<g.length;h++)e(g[h])}function r(a,b,c){var d=v.count(a);d.onsuccess=function(d){var e=d.target.result;if(e)return c();var f={digest:a,body:b},g=v.put(f);g.onsuccess=c}}for(var s,t,u,v,w,x,y=b.docs,z=0,B=0,C=y.length;C>B;B++){var D=y[B];D._id&&fa(D._id)||(D=y[B]=Da(D,c.new_edits),D.error&&!x&&(x=D))}if(x)return g(x);var E=new Array(y.length),F=new rd.Map,G=!1,H=d._meta.blobSupport?"blob":"base64";Sa(y,H,function(a){return a?g(a):void h()})}function jb(a,b,c,d,e){try{if(a&&b)return e?IDBKeyRange.bound(b,a,!c,!1):IDBKeyRange.bound(a,b,!1,!c);if(a)return e?IDBKeyRange.upperBound(a):IDBKeyRange.lowerBound(a);if(b)return e?IDBKeyRange.lowerBound(b,!c):IDBKeyRange.upperBound(b,!c);if(d)return IDBKeyRange.only(d)}catch(f){return{error:f}}return null}function kb(a,b,c,d){return"DataError"===c.name&&0===c.code?d(null,{total_rows:a._meta.docCount,offset:b.skip,rows:[]}):void d(A(Ud,c.name,c.message))}function lb(a,b,c,d){function e(a,d){function e(b,c,d){var e=b.id+"::"+d;x.get(e).onsuccess=function(d){c.doc=cb(d.target.result),a.conflicts&&(c.doc._conflicts=S(b)),eb(c.doc,a,t)}}function f(b,c,d){var f={id:d.id,key:d.id,value:{rev:c}},g=d.deleted;if("ok"===a.deleted)y.push(f),g?(f.value.deleted=!0,f.doc=null):a.include_docs&&e(d,f,c);else if(!g&&m--<=0&&(y.push(f),a.include_docs&&e(d,f,c),0===--n))return;b["continue"]()}function g(a){z=b._meta.docCount;var c=a.target.result;if(c){var d=bb(c.value),e=d.winningRev;f(c,e,d)}}function h(){d(null,{total_rows:z,offset:a.skip,rows:y})}function i(){a.attachments?fb(y,a.binary).then(h):h()}var j="startkey"in a?a.startkey:!1,k="endkey"in a?a.endkey:!1,l="key"in a?a.key:!1,m=a.skip||0,n="number"==typeof a.limit?a.limit:-1,o=a.inclusive_end!==!1,p="descending"in a&&a.descending?"prev":null,q=jb(j,k,o,l,p);if(q&&q.error)return kb(b,a,q.error,d);var r=[re,se];a.attachments&&r.push(te);var s=hb(c,r,"readonly");if(s.error)return d(s.error);var t=s.txn,u=t.objectStore(re),v=t.objectStore(se),w=p?u.openCursor(q,p):u.openCursor(q),x=v.index("_doc_id_rev"),y=[],z=0;t.oncomplete=i,w.onsuccess=g}function f(a,c){return 0===a.limit?c(null,{total_rows:b._meta.docCount,offset:a.skip,rows:[]}):void e(a,c)}f(a,d)}function mb(a){return new yd(function(b){var c=Ga([""]);a.objectStore(xe).put(c,"key"),a.onabort=function(a){a.preventDefault(),a.stopPropagation(),b(!1)},a.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);b(c||!a||parseInt(a[1],10)>=43)}})["catch"](function(){return!1})}function nb(a,b){var c=this;ye.queue.push({action:function(b){ob(c,a,b)},callback:b}),$a(c.constructor)}function ob(a,b,d){function e(a){var b=a.createObjectStore(re,{keyPath:"id"});a.createObjectStore(se,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),a.createObjectStore(te,{keyPath:"digest"}),a.createObjectStore(ve,{keyPath:"id",autoIncrement:!1}),a.createObjectStore(xe),b.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),a.createObjectStore(we,{keyPath:"_id"});var c=a.createObjectStore(ue,{autoIncrement:!0});c.createIndex("seq","seq"),c.createIndex("digestSeq","digestSeq",{unique:!0})}function f(a,b){var c=a.objectStore(re);c.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),c.openCursor().onsuccess=function(a){var d=a.target.result;if(d){var e=d.value,f=ea(e);e.deletedOrLocal=f?"1":"0",c.put(e),d["continue"]()}else b()}}function g(a){a.createObjectStore(we,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function h(a,b){var c=a.objectStore(we),d=a.objectStore(re),e=a.objectStore(se),f=d.openCursor();f.onsuccess=function(a){var f=a.target.result;if(f){var g=f.value,h=g.id,i=fa(h),j=O(g);if(i){var k=h+"::"+j,l=h+"::",m=h+"::~",n=e.index("_doc_id_rev"),o=IDBKeyRange.bound(l,m,!1,!1),p=n.openCursor(o);p.onsuccess=function(a){if(p=a.target.result){var b=p.value;b._doc_id_rev===k&&c.put(b),e["delete"](p.primaryKey),p["continue"]()}else d["delete"](f.primaryKey),f["continue"]()}}else f["continue"]()}else b&&b()}}function i(a){var b=a.createObjectStore(ue,{autoIncrement:!0});b.createIndex("seq","seq"),b.createIndex("digestSeq","digestSeq",{unique:!0})}function k(a,b){var c=a.objectStore(se),d=a.objectStore(te),e=a.objectStore(ue),f=d.count();f.onsuccess=function(a){var d=a.target.result;return d?void(c.openCursor().onsuccess=function(a){var c=a.target.result;if(!c)return b();for(var d=c.value,f=c.primaryKey,g=Object.keys(d._attachments||{}),h={},i=0;i<g.length;i++){var j=d._attachments[g[i]];h[j.digest]=!0}var k=Object.keys(h);for(i=0;i<k.length;i++){var l=k[i];e.put({seq:f,digestSeq:l+"::"+f})}c["continue"]()}):b()}}function m(a){function b(a){return a.data?bb(a):(a.deleted="1"===a.deletedOrLocal,a)}var c=a.objectStore(se),d=a.objectStore(re),e=d.openCursor();e.onsuccess=function(a){function e(){var a=h.id+"::",b=h.id+"::￿",d=c.index("_doc_id_rev").openCursor(IDBKeyRange.bound(a,b)),e=0;d.onsuccess=function(a){var b=a.target.result;if(!b)return h.seq=e,f();var c=b.primaryKey;c>e&&(e=c),b["continue"]()}}function f(){var a=ab(h,h.winningRev,h.deleted),b=d.put(a);b.onsuccess=function(){g["continue"]()}}var g=a.target.result;if(g){var h=b(g.value);return h.winningRev=h.winningRev||O(h),h.seq?f():void e()}}}var n=b.name,o=null;a._meta=null,a.type=function(){return"idb"},a._id=l(function(b){b(null,a._meta.instanceId)}),a._bulkDocs=function(c,d,e){ib(b,c,d,a,o,Ae,e)},a._get=function(a,b,c){function d(){c(g,{doc:e,metadata:f,ctx:h})}var e,f,g,h=b.ctx;if(!h){var i=hb(o,[re,se,te],"readonly");if(i.error)return c(i.error);h=i.txn}h.objectStore(re).get(a).onsuccess=function(a){if(f=bb(a.target.result),!f)return g=A(Gd,"missing"),d();if(ea(f)&&!b.rev)return g=A(Gd,"deleted"),d();var c=h.objectStore(se),i=b.rev||f.winningRev,j=f.id+"::"+i;c.index("_doc_id_rev").get(j).onsuccess=function(a){return e=a.target.result,e&&(e=cb(e)),e?void d():(g=A(Gd,"missing"),d())}}},a._getAttachment=function(a,b,c,d,e){var f;if(d.ctx)f=d.ctx;else{var g=hb(o,[re,se,te],"readonly");if(g.error)return e(g.error);f=g.txn}var h=c.digest,i=c.content_type;f.objectStore(te).get(h).onsuccess=function(a){var b=a.target.result.body;db(b,i,d.binary,function(a){e(null,a)})}},a._info=function(b){if(null===o||!ze.has(n)){var c=new Error("db isn't open");return c.id="idbNull",b(c)}var d,e,f=hb(o,[se],"readonly");if(f.error)return b(f.error);var g=f.txn,h=g.objectStore(se).openCursor(null,"prev");h.onsuccess=function(b){var c=b.target.result;d=c?c.key:0,e=a._meta.docCount},g.oncomplete=function(){b(null,{doc_count:e,update_seq:d,idb_attachment_format:a._meta.blobSupport?"binary":"base64"})}},a._allDocs=function(b,c){lb(b,a,o,c)},a._changes=function(b){function c(a){function c(){return j.seq!==g?a["continue"]():(i=g,j.winningRev===f._rev?e(f):void d())}function d(){var a=f._id+"::"+j.winningRev,b=r.get(a);b.onsuccess=function(a){e(cb(a.target.result))}}function e(c){var d=b.processChange(c,j,b);d.seq=j.seq;var e=u(d);return"object"==typeof e?b.complete(e):(e&&(t++,l&&s.push(d),b.attachments&&b.include_docs?eb(c,b,m,function(){fb([d],b.binary).then(function(){b.onChange(d)})}):b.onChange(d)),void(t!==k&&a["continue"]()))}var f=cb(a.value),g=a.key;if(h&&!h.has(f._id))return a["continue"]();var j;return(j=v.get(f._id))?c():void(q.get(f._id).onsuccess=function(a){j=bb(a.target.result),v.set(f._id,j),c()})}function d(a){var b=a.target.result;b&&c(b)}function e(){var a=[re,se];b.attachments&&a.push(te);var c=hb(o,a,"readonly");if(c.error)return b.complete(c.error);m=c.txn,m.onabort=_a(b.complete),m.oncomplete=f,p=m.objectStore(se),q=m.objectStore(re),r=p.index("_doc_id_rev");var e;e=b.descending?p.openCursor(null,"prev"):p.openCursor(IDBKeyRange.lowerBound(b.since,!0)),e.onsuccess=d}function f(){function a(){b.complete(null,{results:s,last_seq:i})}!b.continuous&&b.attachments?fb(s).then(a):a()}if(b=j(b),b.continuous){var g=n+":"+N();return Ae.addListener(n,g,a,b),Ae.notify(n),{cancel:function(){Ae.removeListener(n,g)}}}var h=b.doc_ids&&new rd.Set(b.doc_ids);b.since=b.since||0;var i=b.since,k="limit"in b?b.limit:-1;0===k&&(k=1);var l;l="return_docs"in b?b.return_docs:"returnDocs"in b?b.returnDocs:!0;var m,p,q,r,s=[],t=0,u=D(b),v=new rd.Map;e()},a._close=function(a){return null===o?a(A(Ld)):(o.close(),ze["delete"](n),o=null,void a())},a._getRevisionTree=function(a,b){var c=hb(o,[re],"readonly");if(c.error)return b(c.error);var d=c.txn,e=d.objectStore(re).get(a);e.onsuccess=function(a){var c=bb(a.target.result);c?b(null,c.rev_tree):b(A(Gd))}},a._doCompaction=function(a,b,c){var d=[re,se,te,ue],e=hb(o,d,"readwrite");if(e.error)return c(e.error);var f=e.txn,g=f.objectStore(re);g.get(a).onsuccess=function(c){var d=bb(c.target.result);P(d.rev_tree,function(a,c,d,e,f){var g=c+"-"+d;-1!==b.indexOf(g)&&(f.status="missing")}),gb(b,a,f);var e=d.winningRev,g=d.deleted;f.objectStore(re).put(ab(d,e,g))},f.onabort=_a(c),f.oncomplete=function(){c()}},a._getLocal=function(a,b){var c=hb(o,[we],"readonly");if(c.error)return b(c.error);var d=c.txn,e=d.objectStore(we).get(a);e.onerror=_a(b),e.onsuccess=function(a){var c=a.target.result;c?(delete c._doc_id_rev,b(null,c)):b(A(Gd))}},a._putLocal=function(a,b,c){"function"==typeof b&&(c=b,b={}),delete a._revisions;var d=a._rev,e=a._id;d?a._rev="0-"+(parseInt(d.split("-")[1],10)+1):a._rev="0-1";var f,g=b.ctx;if(!g){var h=hb(o,[we],"readwrite");if(h.error)return c(h.error);g=h.txn,g.onerror=_a(c),g.oncomplete=function(){f&&c(null,f)}}var i,j=g.objectStore(we);d?(i=j.get(e),i.onsuccess=function(e){var g=e.target.result;if(g&&g._rev===d){var h=j.put(a);h.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)}}else c(A(Hd))}):(i=j.add(a),i.onerror=function(a){c(A(Hd)),a.preventDefault(),a.stopPropagation()},i.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)})},a._removeLocal=function(a,b,c){"function"==typeof b&&(c=b,b={});var d=b.ctx;if(!d){var e=hb(o,[we],"readwrite");if(e.error)return c(e.error);d=e.txn,d.oncomplete=function(){f&&c(null,f)}}var f,g=a._id,h=d.objectStore(we),i=h.get(g);i.onerror=_a(c),i.onsuccess=function(d){var e=d.target.result;e&&e._rev===a._rev?(h["delete"](g),f={ok:!0,id:g,rev:"0-0"},b.ctx&&c(null,f)):c(A(Gd))}},a._destroy=function(a,b){Ae.removeAllListeners(n);var c=Be.get(n);c&&c.result&&(c.result.close(),ze["delete"](n));var d=indexedDB.deleteDatabase(n);d.onsuccess=function(){Be["delete"](n),s()&&n in localStorage&&delete localStorage[n],b(null,{ok:!0})},d.onerror=_a(b)};var p=ze.get(n);if(p)return o=p.idb,a._meta=p.global,void c.nextTick(function(){d(null,a)});var q;q=b.storage?pb(n,b.storage):indexedDB.open(n,qe),Be.set(n,q),q.onupgradeneeded=function(a){function b(){var a=j[l-1];l++,a&&a(d,b)}var c=a.target.result;if(a.oldVersion<1)return e(c);var d=a.currentTarget.transaction;a.oldVersion<3&&g(c),a.oldVersion<4&&i(c);var j=[f,h,k,m],l=a.oldVersion;b()},q.onsuccess=function(b){o=b.target.result,o.onversionchange=function(){o.close(),ze["delete"](n)},o.onabort=function(a){v("error","Database has a global failure",a.target.error),o.close(),ze["delete"](n)};var c=o.transaction([ve,xe,re],"readwrite"),e=c.objectStore(ve).get(ve),f=null,g=null,h=null;e.onsuccess=function(b){var e=function(){null!==f&&null!==g&&null!==h&&(a._meta={name:n,instanceId:h,blobSupport:f,docCount:g},ze.set(n,{idb:o,global:a._meta}),d(null,a))},i=b.target.result||{id:ve};n+"_id"in i?(h=i[n+"_id"],e()):(h=N(),i[n+"_id"]=h,c.objectStore(ve).put(i).onsuccess=function(){e()}),je||(je=mb(c)),je.then(function(a){f=a,e()});var j=c.objectStore(re).index("deletedOrLocal");j.count(IDBKeyRange.only("0")).onsuccess=function(a){g=a.target.result,e()}}},q.onerror=function(){var a="Failed to open indexedDB, are you in private browsing mode?";v("error",a),d(A(Ud,a))}}function pb(a,b){try{return indexedDB.open(a,{version:qe,storage:b})}catch(c){return indexedDB.open(a,qe)}}function qb(a){a.adapter("idb",nb,!0)}function rb(a){return decodeURIComponent(escape(a))}function sb(a){return 65>a?a-48:a-55}function tb(a,b,c){for(var d="";c>b;)d+=String.fromCharCode(sb(a.charCodeAt(b++))<<4|sb(a.charCodeAt(b++)));return d}function ub(a,b,c){for(var d="";c>b;)d+=String.fromCharCode(sb(a.charCodeAt(b+2))<<12|sb(a.charCodeAt(b+3))<<8|sb(a.charCodeAt(b))<<4|sb(a.charCodeAt(b+1))),b+=4;return d}function vb(a,b){return"UTF-8"===b?rb(tb(a,0,a.length)):ub(a,0,a.length)}function wb(a){return"'"+a+"'"}function xb(a){return a.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function yb(a){return a.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function zb(a){return delete a._id,delete a._rev,JSON.stringify(a)}function Ab(a,b,c){return a=JSON.parse(a),a._id=b,a._rev=c,a}function Bb(a){for(var b="(";a--;)b+="?",a&&(b+=",");return b+")"}function Cb(a,b,c,d,e){return"SELECT "+a+" FROM "+("string"==typeof b?b:b.join(" JOIN "))+(c?" ON "+c:"")+(d?" WHERE "+("string"==typeof d?d:d.join(" AND ")):"")+(e?" ORDER BY "+e:"")}function Db(a,b,c){function d(){++f===a.length&&e()}function e(){if(g.length){var a="SELECT DISTINCT digest AS digest FROM "+Ie+" WHERE seq IN "+Bb(g.length);c.executeSql(a,g,function(a,b){for(var c=[],d=0;d<b.rows.length;d++)c.push(b.rows.item(d).digest);if(c.length){var e="DELETE FROM "+Ie+" WHERE seq IN ("+g.map(function(){return"?"}).join(",")+")";a.executeSql(e,g,function(a){var b="SELECT digest FROM "+Ie+" WHERE digest IN ("+c.map(function(){return"?"}).join(",")+")";a.executeSql(b,c,function(a,b){for(var d=new rd.Set,e=0;e<b.rows.length;e++)d.add(b.rows.item(e).digest);c.forEach(function(b){d.has(b)||(a.executeSql("DELETE FROM "+Ie+" WHERE digest=?",[b]),a.executeSql("DELETE FROM "+Fe+" WHERE digest=?",[b]))})})})}})}}if(a.length){var f=0,g=[];a.forEach(function(a){var e="SELECT seq FROM "+Ee+" WHERE doc_id=? AND rev=?";c.executeSql(e,[b,a],function(a,b){if(!b.rows.length)return d();var c=b.rows.item(0).seq;g.push(c),a.executeSql("DELETE FROM "+Ee+" WHERE seq=?",[c],d)})})}}function Eb(a){return function(b){v("error","WebSQL threw an error",b);var c=b&&b.constructor.toString().match(/function ([^\(]+)/),d=c&&c[1]||b.type,e=b.target||b.message;a(A(Vd,e,d))}}function Fb(a){if("size"in a)return 1e6*a.size;var b="undefined"!=typeof navigator&&/Android/.test(navigator.userAgent);return b?5e6:1}function Gb(a,b,c,d,e,f,g){function h(){return t?g(t):(f.notify(d._name),d._docCount=-1,void g(null,u))}function i(a,b){var c="SELECT count(*) as cnt FROM "+Fe+" WHERE digest=?";s.executeSql(c,[a],function(c,d){if(0===d.rows.item(0).cnt){var e=A($d,"unknown stub attachment with digest "+a);b(e)}else b()})}function j(a){function b(){++e===c.length&&a(d)}var c=[];if(q.forEach(function(a){a.data&&a.data._attachments&&Object.keys(a.data._attachments).forEach(function(b){var d=a.data._attachments[b];d.stub&&c.push(d.digest)})}),!c.length)return a();var d,e=0;c.forEach(function(a){i(a,function(a){a&&!d&&(d=a),b()})})}function k(a,b,c,e,f,g,h,i){function j(){function b(a,b){function d(){return++f===g.length&&b(),!1}function e(b){var e="INSERT INTO "+Ie+" (digest, seq) VALUES (?,?)",f=[c._attachments[b].digest,a];s.executeSql(e,f,d,d)}var f=0,g=Object.keys(c._attachments||{});if(!g.length)return b();for(var h=0;h<g.length;h++)e(g[h])}var c=a.data,d=e?1:0,f=c._id,g=c._rev,h=zb(c),i="INSERT INTO "+Ee+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",j=[f,g,h,d];s.executeSql(i,j,function(a,c){var d=c.insertId;b(d,function(){m(a,d)})},function(){var a=Cb("seq",Ee,null,"doc_id=? AND rev=?");return s.executeSql(a,[f,g],function(a,c){var e=c.rows.item(0).seq,i="UPDATE "+Ee+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",j=[h,d,f,g];a.executeSql(i,j,function(a){b(e,function(){m(a,e)})})}),!1})}function k(a){o||(a?(o=a,i(o)):p===q.length&&j())}function l(a){p++,k(a)}function m(c,e){var g=a.metadata.id,j=a.stemmedRevs||[];f&&d.auto_compaction&&(j=T(a.metadata).concat(j)),j.length&&Db(j,g,c),a.metadata.seq=e,delete a.metadata.rev;var k=f?"UPDATE "+De+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+Ee+" WHERE doc_id="+De+".id AND rev=?) WHERE id=?":"INSERT INTO "+De+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",l=Ya(a.metadata),m=f?[l,e,b,g]:[g,e,e,l];c.executeSql(k,m,function(){u[h]={ok:!0,id:a.metadata.id,rev:b},v.set(g,a.metadata),i()})}var o=null,p=0;a.data._id=a.metadata.id,a.data._rev=a.metadata.rev;var q=Object.keys(a.data._attachments||{});e&&(a.data._deleted=!0),q.forEach(function(c){var d=a.data._attachments[c];if(d.stub)p++,k();else{var e=d.data;delete d.data,d.revpos=parseInt(b,10);var f=d.digest;n(f,e,l)}}),q.length||j()}function l(){Va(a.revs_limit,q,d,v,s,u,k,c)}function m(a){function b(){++c===q.length&&a()}if(!q.length)return a();var c=0;q.forEach(function(a){if(a._id&&fa(a._id))return b();var c=a.metadata.id;s.executeSql("SELECT json FROM "+De+" WHERE id = ?",[c],function(a,d){if(d.rows.length){var e=Xa(d.rows.item(0).json);v.set(c,e)}b()})})}function n(a,b,c){var d="SELECT digest FROM "+Fe+" WHERE digest=?";s.executeSql(d,[a],function(e,f){return f.rows.length?c():(d="INSERT INTO "+Fe+" (digest, body, escaped) VALUES (?,?,1)",void e.executeSql(d,[a,xb(b)],function(){c()},function(){return c(),!1}))})}var o=c.new_edits,p=b.docs,q=p.map(function(a){if(a._id&&fa(a._id))return a;var b=Da(a,o);return b}),r=q.filter(function(a){return a.error});if(r.length)return g(r[0]);var s,t,u=new Array(q.length),v=new rd.Map;Sa(q,"binary",function(a){return a?g(a):void e.transaction(function(a){s=a,j(function(a){a?t=a:m(l)})},Eb(g),h)})}function Hb(a){return a.websql(a.name,a.version,a.description,a.size)}function Ib(a){try{return{db:Hb(a)}}catch(b){return{error:b}}}function Jb(a){var b=Je.get(a.name);return b||(b=Ib(a),Je.set(a.name,b),b.db&&(b.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),b}function Kb(a,b,c,d,e){function f(){++i===h.length&&e&&e()}function g(a,e){var g=a._attachments[e],h={binary:b.binary,ctx:d};c._getAttachment(a._id,e,g,h,function(b,c){a._attachments[e]=nd.extend(n(g,["digest","content_type"]),{data:c}),f()})}var h=Object.keys(a._attachments||{});if(!h.length)return e&&e();var i=0;h.forEach(function(c){b.attachments&&b.include_docs?g(a,c):(a._attachments[c].stub=!0,f())})}function Lb(a,b){function c(){s()&&(window.localStorage["_pouch__websqldb_"+t._name]=!0),b(null,t)}function d(a,b){a.executeSql(Oe),a.executeSql("ALTER TABLE "+Ee+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){a.executeSql(Me),a.executeSql("ALTER TABLE "+De+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){a.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+De+" (local, id)");var c="SELECT "+De+".winningseq AS seq, "+De+".json AS metadata FROM "+Ee+" JOIN "+De+" ON "+Ee+".seq = "+De+".winningseq";a.executeSql(c,[],function(a,c){for(var d=[],e=[],f=0;f<c.rows.length;f++){var g=c.rows.item(f),h=g.seq,i=JSON.parse(g.metadata);ea(i)&&d.push(h),fa(i.id)&&e.push(i.id)}a.executeSql("UPDATE "+De+"SET local = 1 WHERE id IN "+Bb(e.length),e,function(){a.executeSql("UPDATE "+Ee+" SET deleted = 1 WHERE seq IN "+Bb(d.length),d,b)})})})})}function e(a,b){var c="CREATE TABLE IF NOT EXISTS "+Ge+" (id UNIQUE, rev, json)";a.executeSql(c,[],function(){var c="SELECT "+De+".id AS id, "+Ee+".json AS data FROM "+Ee+" JOIN "+De+" ON "+Ee+".seq = "+De+".winningseq WHERE local = 1";a.executeSql(c,[],function(a,c){function d(){if(!e.length)return b(a);var c=e.shift(),f=JSON.parse(c.data)._rev;a.executeSql("INSERT INTO "+Ge+" (id, rev, json) VALUES (?,?,?)",[c.id,f,c.data],function(a){a.executeSql("DELETE FROM "+De+" WHERE id=?",[c.id],function(a){a.executeSql("DELETE FROM "+Ee+" WHERE seq=?",[c.seq],function(){d()})})})}for(var e=[],f=0;f<c.rows.length;f++)e.push(c.rows.item(f));d()})})}function f(a,b){function c(c){function d(){if(!c.length)return b(a);var e=c.shift(),f=vb(e.hex,r),g=f.lastIndexOf("::"),h=f.substring(0,g),i=f.substring(g+2),j="UPDATE "+Ee+" SET doc_id=?, rev=? WHERE doc_id_rev=?";a.executeSql(j,[h,i,f],function(){d()})}d()}var d="ALTER TABLE "+Ee+" ADD COLUMN doc_id";a.executeSql(d,[],function(a){var b="ALTER TABLE "+Ee+" ADD COLUMN rev";a.executeSql(b,[],function(a){a.executeSql(Ne,[],function(a){var b="SELECT hex(doc_id_rev) as hex FROM "+Ee;a.executeSql(b,[],function(a,b){for(var d=[],e=0;e<b.rows.length;e++)d.push(b.rows.item(e));c(d)})})})})}function g(a,b){function c(a){var c="SELECT COUNT(*) AS cnt FROM "+Fe;a.executeSql(c,[],function(a,c){function d(){var c=Cb(Se+", "+De+".id AS id",[De,Ee],Re,null,De+".id ");c+=" LIMIT "+g+" OFFSET "+f,f+=g,a.executeSql(c,[],function(a,c){function e(a,b){var c=f[a]=f[a]||[];-1===c.indexOf(b)&&c.push(b)}if(!c.rows.length)return b(a);for(var f={},g=0;g<c.rows.length;g++)for(var h=c.rows.item(g),i=Ab(h.data,h.id,h.rev),j=Object.keys(i._attachments||{}),k=0;k<j.length;k++){var l=i._attachments[j[k]];e(l.digest,h.seq)}var m=[];if(Object.keys(f).forEach(function(a){var b=f[a];b.forEach(function(b){m.push([a,b])})}),!m.length)return d();var n=0;m.forEach(function(b){var c="INSERT INTO "+Ie+" (digest, seq) VALUES (?,?)";a.executeSql(c,b,function(){++n===m.length&&d()})})})}var e=c.rows.item(0).cnt;if(!e)return b(a);var f=0,g=10;d()})}var d="CREATE TABLE IF NOT EXISTS "+Ie+" (digest, seq INTEGER)";a.executeSql(d,[],function(a){a.executeSql(Qe,[],function(a){a.executeSql(Pe,[],c)})})}function h(a,b){var c="ALTER TABLE "+Fe+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";a.executeSql(c,[],b)}function i(a,b){var c="ALTER TABLE "+De+" ADD COLUMN max_seq INTEGER";a.executeSql(c,[],function(a){var c="UPDATE "+De+" SET max_seq=(SELECT MAX(seq) FROM "+Ee+" WHERE doc_id=id)";a.executeSql(c,[],function(a){var c="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+De+" (max_seq)";a.executeSql(c,[],b)})})}function k(a,b){a.executeSql('SELECT HEX("a") AS hex',[],function(a,c){var d=c.rows.item(0).hex;r=2===d.length?"UTF-8":"UTF-16",b()})}function m(){for(;w.length>0;){var a=w.pop();a(null,u)}}function n(a,b){if(0===b){var c="CREATE TABLE IF NOT EXISTS "+He+" (dbid, db_version INTEGER)",j="CREATE TABLE IF NOT EXISTS "+Fe+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",k="CREATE TABLE IF NOT EXISTS "+Ie+" (digest, seq INTEGER)",l="CREATE TABLE IF NOT EXISTS "+De+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",n="CREATE TABLE IF NOT EXISTS "+Ee+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",o="CREATE TABLE IF NOT EXISTS "+Ge+" (id UNIQUE, rev, json)";a.executeSql(j),a.executeSql(o),a.executeSql(k,[],function(){a.executeSql(Pe),a.executeSql(Qe)}),a.executeSql(l,[],function(){a.executeSql(Oe),a.executeSql(n,[],function(){a.executeSql(Me),a.executeSql(Ne),a.executeSql(c,[],function(){var b="INSERT INTO "+He+" (db_version, dbid) VALUES (?,?)";u=N();var c=[Ce,u];a.executeSql(b,c,function(){m()})})})})}else{var p=function(){var c=Ce>b;c&&a.executeSql("UPDATE "+He+" SET db_version = "+Ce);var d="SELECT dbid FROM "+He;a.executeSql(d,[],function(a,b){u=b.rows.item(0).dbid,m()})},q=[d,e,f,g,h,i,p],r=b,s=function(a){q[r-1](a,s),r++};s(a)}}function o(){z.transaction(function(a){k(a,function(){p(a)})},Eb(b),c)}function p(a){var b="SELECT sql FROM sqlite_master WHERE tbl_name = "+He;a.executeSql(b,[],function(a,b){b.rows.length?/db_version/.test(b.rows.item(0).sql)?a.executeSql("SELECT db_version FROM "+He,[],function(a,b){var c=b.rows.item(0).db_version;n(a,c)}):a.executeSql("ALTER TABLE "+He+" ADD COLUMN db_version INTEGER",[],function(){n(a,1)}):n(a,0)})}function q(a,b){if(-1!==t._docCount)return b(t._docCount);var c=Cb("COUNT("+De+".id) AS 'num'",[De,Ee],Re,Ee+".deleted=0");a.executeSql(c,[],function(a,c){t._docCount=c.rows.item(0).num,b(t._docCount)})}var r,t=this,u=null,v=Fb(a),w=[];t._docCount=-1,t._name=a.name;var x=nd.extend({},a,{version:Le,description:a.name,size:v}),y=Jb(x);if(y.error)return Eb(b)(y.error);var z=y.db;"function"!=typeof z.readTransaction&&(z.readTransaction=z.transaction),o(),t.type=function(){return"websql"},t._id=l(function(a){a(null,u)}),t._info=function(a){z.readTransaction(function(b){q(b,function(c){var d="SELECT MAX(seq) AS seq FROM "+Ee;b.executeSql(d,[],function(b,d){var e=d.rows.item(0).seq||0;a(null,{doc_count:c,update_seq:e,sqlite_plugin:z._sqlitePlugin,websql_encoding:r})})})},Eb(a))},t._bulkDocs=function(b,c,d){Gb(a,b,c,t,z,Ke,d)},t._get=function(a,b,c){function d(){c(g,{doc:e,metadata:f,ctx:h})}var e,f,g,h=b.ctx;if(!h)return z.readTransaction(function(d){t._get(a,nd.extend({ctx:d},b),c)});var i,j;b.rev?(i=Cb(Se,[De,Ee],De+".id="+Ee+".doc_id",[Ee+".doc_id=?",Ee+".rev=?"]),
j=[a,b.rev]):(i=Cb(Se,[De,Ee],Re,De+".id=?"),j=[a]),h.executeSql(i,j,function(a,c){if(!c.rows.length)return g=A(Gd,"missing"),d();var h=c.rows.item(0);return f=Xa(h.metadata),h.deleted&&!b.rev?(g=A(Gd,"deleted"),d()):(e=Ab(h.data,f.id,h.rev),void d())})},t._allDocs=function(a,b){var c,d=[],e="startkey"in a?a.startkey:!1,f="endkey"in a?a.endkey:!1,g="key"in a?a.key:!1,h="descending"in a?a.descending:!1,i="limit"in a?a.limit:-1,j="skip"in a?a.skip:0,k=a.inclusive_end!==!1,l=[],m=[];if(g!==!1)m.push(De+".id = ?"),l.push(g);else if(e!==!1||f!==!1){if(e!==!1&&(m.push(De+".id "+(h?"<=":">=")+" ?"),l.push(e)),f!==!1){var n=h?">":"<";k&&(n+="="),m.push(De+".id "+n+" ?"),l.push(f)}g!==!1&&(m.push(De+".id = ?"),l.push(g))}"ok"!==a.deleted&&m.push(Ee+".deleted = 0"),z.readTransaction(function(b){q(b,function(e){if(c=e,0!==i){var f=Cb(Se,[De,Ee],Re,m,De+".id "+(h?"DESC":"ASC"));f+=" LIMIT "+i+" OFFSET "+j,b.executeSql(f,l,function(b,c){for(var e=0,f=c.rows.length;f>e;e++){var g=c.rows.item(e),h=Xa(g.metadata),i=h.id,j=Ab(g.data,i,g.rev),k=j._rev,l={id:i,key:i,value:{rev:k}};if(a.include_docs&&(l.doc=j,l.doc._rev=k,a.conflicts&&(l.doc._conflicts=S(h)),Kb(l.doc,a,t,b)),g.deleted){if("ok"!==a.deleted)continue;l.value.deleted=!0,l.doc=null}d.push(l)}})}})},Eb(b),function(){b(null,{total_rows:c,offset:a.skip,rows:d})})},t._changes=function(a){function b(){var b=De+".json AS metadata, "+De+".max_seq AS maxSeq, "+Ee+".json AS winningDoc, "+Ee+".rev AS winningRev ",c=De+" JOIN "+Ee,i=De+".id="+Ee+".doc_id AND "+De+".winningseq="+Ee+".seq",j=["maxSeq > ?"],k=[a.since];a.doc_ids&&(j.push(De+".id IN "+Bb(a.doc_ids.length)),k=k.concat(a.doc_ids));var l="maxSeq "+(d?"DESC":"ASC"),m=Cb(b,c,i,j,l),n=D(a);a.view||a.filter||(m+=" LIMIT "+e);var o=a.since||0;z.readTransaction(function(b){b.executeSql(m,k,function(b,c){function d(b){return function(){a.onChange(b)}}for(var i=0,j=c.rows.length;j>i;i++){var k=c.rows.item(i),l=Xa(k.metadata);o=k.maxSeq;var m=Ab(k.winningDoc,l.id,k.winningRev),p=a.processChange(m,l,a);p.seq=k.maxSeq;var q=n(p);if("object"==typeof q)return a.complete(q);if(q&&(h++,f&&g.push(p),a.attachments&&a.include_docs?Kb(m,a,t,b,d(p)):d(p)()),h===e)break}})},Eb(a.complete),function(){a.continuous||a.complete(null,{results:g,last_seq:o})})}if(a=j(a),a.continuous){var c=t._name+":"+N();return Ke.addListener(t._name,c,t,a),Ke.notify(t._name),{cancel:function(){Ke.removeListener(t._name,c)}}}var d=a.descending;a.since=a.since&&!d?a.since:0;var e="limit"in a?a.limit:-1;0===e&&(e=1);var f;f="return_docs"in a?a.return_docs:"returnDocs"in a?a.returnDocs:!0;var g=[],h=0;b()},t._close=function(a){a()},t._getAttachment=function(a,b,c,d,e){var f,g=d.ctx,h=c.digest,i=c.content_type,j="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+Fe+" WHERE digest=?";g.executeSql(j,[h],function(a,b){var c=b.rows.item(0),g=c.escaped?yb(c.body):vb(c.body,r);f=d.binary?Ia(g,i):ne(g),e(null,f)})},t._getRevisionTree=function(a,b){z.readTransaction(function(c){var d="SELECT json AS metadata FROM "+De+" WHERE id = ?";c.executeSql(d,[a],function(a,c){if(c.rows.length){var d=Xa(c.rows.item(0).metadata);b(null,d.rev_tree)}else b(A(Gd))})})},t._doCompaction=function(a,b,c){return b.length?void z.transaction(function(c){var d="SELECT json AS metadata FROM "+De+" WHERE id = ?";c.executeSql(d,[a],function(c,d){var e=Xa(d.rows.item(0).metadata);P(e.rev_tree,function(a,c,d,e,f){var g=c+"-"+d;-1!==b.indexOf(g)&&(f.status="missing")});var f="UPDATE "+De+" SET json = ? WHERE id = ?";c.executeSql(f,[Ya(e),a])}),Db(b,a,c)},Eb(c),function(){c()}):c()},t._getLocal=function(a,b){z.readTransaction(function(c){var d="SELECT json, rev FROM "+Ge+" WHERE id=?";c.executeSql(d,[a],function(c,d){if(d.rows.length){var e=d.rows.item(0),f=Ab(e.json,a,e.rev);b(null,f)}else b(A(Gd))})})},t._putLocal=function(a,b,c){function d(a){var d,j;f?(d="UPDATE "+Ge+" SET rev=?, json=? WHERE id=? AND rev=?",j=[e,i,g,f]):(d="INSERT INTO "+Ge+" (id, rev, json) VALUES (?,?,?)",j=[g,e,i]),a.executeSql(d,j,function(a,d){d.rowsAffected?(h={ok:!0,id:g,rev:e},b.ctx&&c(null,h)):c(A(Hd))},function(){return c(A(Hd)),!1})}"function"==typeof b&&(c=b,b={}),delete a._revisions;var e,f=a._rev,g=a._id;e=f?a._rev="0-"+(parseInt(f.split("-")[1],10)+1):a._rev="0-1";var h,i=zb(a);b.ctx?d(b.ctx):z.transaction(d,Eb(c),function(){h&&c(null,h)})},t._removeLocal=function(a,b,c){function d(d){var f="DELETE FROM "+Ge+" WHERE id=? AND rev=?",g=[a._id,a._rev];d.executeSql(f,g,function(d,f){return f.rowsAffected?(e={ok:!0,id:a._id,rev:"0-0"},void(b.ctx&&c(null,e))):c(A(Gd))})}"function"==typeof b&&(c=b,b={});var e;b.ctx?d(b.ctx):z.transaction(d,Eb(c),function(){e&&c(null,e)})},t._destroy=function(a,b){Ke.removeAllListeners(t._name),z.transaction(function(a){var b=[De,Ee,Fe,He,Ge,Ie];b.forEach(function(b){a.executeSql("DROP TABLE IF EXISTS "+b,[])})},Eb(b),function(){s()&&(delete window.localStorage["_pouch__websqldb_"+t._name],delete window.localStorage[t._name]),b(null,{ok:!0})})}}function Mb(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(a){return!1}}function Nb(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var a=s(),b="_pouch__websqldb_valid_"+navigator.userAgent;if(a&&localStorage[b])return"1"===localStorage[b];var c=Mb();return a&&(localStorage[b]=c?"1":"0"),c}function Ob(){return"undefined"!=typeof SQLitePlugin?!0:"undefined"==typeof openDatabase?!1:Nb()}function Pb(a){return function(b,c,d,e){if("undefined"!=typeof sqlitePlugin){var f=nd.extend({},a,{name:b,version:c,description:d,size:e});return sqlitePlugin.openDatabase(f)}return openDatabase(b,c,d,e)}}function Qb(a,b){var c=Pb(a),d=nd.extend({websql:c},a);Lb.call(this,d,b)}function Rb(a){a.adapter("websql",Qb,!0)}function Sb(){for(var a={},b=new yd(function(b,c){a.resolve=b,a.reject=c}),c=new Array(arguments.length),d=0;d<c.length;d++)c[d]=arguments[d];return a.promise=b,yd.resolve().then(function(){return fetch.apply(null,c)}).then(function(b){a.resolve(b)})["catch"](function(b){a.reject(b)}),a}function Tb(a,b){var c,d,e,f=new Headers,g={method:a.method,credentials:"include",headers:f};return a.json&&(f.set("Accept","application/json"),f.set("Content-Type",a.headers["Content-Type"]||"application/json")),a.body&&a.body instanceof Blob?Ma(a.body,function(a){g.body=a}):a.body&&a.processData&&"string"!=typeof a.body?g.body=JSON.stringify(a.body):"body"in a?g.body=a.body:g.body=null,Object.keys(a.headers).forEach(function(b){a.headers.hasOwnProperty(b)&&f.set(b,a.headers[b])}),c=Sb(a.url,g),a.timeout>0&&(d=setTimeout(function(){c.reject(new Error("Load timeout for resource: "+a.url))},a.timeout)),c.promise.then(function(b){return e={statusCode:b.status},a.timeout>0&&clearTimeout(d),e.statusCode>=200&&e.statusCode<300?a.binary?b.blob():b.text():b.json()}).then(function(a){e.statusCode>=200&&e.statusCode<300?b(null,e,a):b(a,e)})["catch"](function(a){b(a,e)}),{abort:c.reject}}function Ub(a,b){var c,d,e=!1,f=function(){c.abort()},g=function(){e=!0,c.abort()};c=a.xhr?new a.xhr:new XMLHttpRequest;try{c.open(a.method,a.url)}catch(h){b(h,{statusCode:413})}c.withCredentials="withCredentials"in a?a.withCredentials:!0,"GET"===a.method?delete a.headers["Content-Type"]:a.json&&(a.headers.Accept="application/json",a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.body&&a.processData&&"string"!=typeof a.body&&(a.body=JSON.stringify(a.body))),a.binary&&(c.responseType="arraybuffer"),"body"in a||(a.body=null);for(var i in a.headers)a.headers.hasOwnProperty(i)&&c.setRequestHeader(i,a.headers[i]);return a.timeout>0&&(d=setTimeout(g,a.timeout),c.onprogress=function(){clearTimeout(d),4!==c.readyState&&(d=setTimeout(g,a.timeout))},"undefined"!=typeof c.upload&&(c.upload.onprogress=c.onprogress)),c.onreadystatechange=function(){if(4===c.readyState){var d={statusCode:c.status};if(c.status>=200&&c.status<300){var f;f=a.binary?Ga([c.response||""],{type:c.getResponseHeader("Content-Type")}):c.responseText,b(null,d,f)}else{var g={};if(e)g=new Error("ETIMEDOUT"),d.statusCode=400;else try{g=JSON.parse(c.response)}catch(h){}b(g,d)}}},a.body&&a.body instanceof Blob?Ma(a.body,function(a){c.send(a)}):c.send(a.body),{abort:f}}function Vb(){try{return new XMLHttpRequest,!0}catch(a){return!1}}function Wb(a,b){return Te||a.xhr?Ub(a,b):Tb(a,b)}function Xb(){return""}function Yb(a,b){function c(b,c,d){if(!a.binary&&a.json&&"string"==typeof b)try{b=JSON.parse(b)}catch(e){return d(e)}Array.isArray(b)&&(b=b.map(function(a){return a.error||a.missing?B(a):a})),a.binary&&Ue(b,c),d(null,b,c)}function d(a,b){var c,d;if(a.code&&a.status){var e=new Error(a.message||a.code);return e.status=a.status,b(e)}if(a.message&&"ETIMEDOUT"===a.message)return b(a);try{c=JSON.parse(a.responseText),d=B(c)}catch(f){d=B(a)}b(d)}a=j(a);var e={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return a=nd.extend(e,a),a.json&&(a.binary||(a.headers.Accept="application/json"),a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json"),a.binary&&(a.encoding=null,a.json=!1),a.processData||(a.json=!1),Wb(a,function(e,f,g){if(e)return e.status=f?f.statusCode:400,d(e,b);var h,i=f.headers&&f.headers["content-type"],j=g||Xb();if(!a.binary&&(a.json||!a.processData)&&"object"!=typeof j&&(/json/.test(i)||/^[\s]*\{/.test(j)&&/\}[\s]*$/.test(j)))try{j=JSON.parse(j.toString())}catch(k){}f.statusCode>=200&&f.statusCode<300?c(j,f,b):(h=B(j),h.status=f.statusCode,b(h))})}function Zb(a,b){var c=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",d=-1!==c.indexOf("safari")&&-1===c.indexOf("chrome"),e=-1!==c.indexOf("msie"),f=-1!==c.indexOf("edge"),g=d||(e||f)&&"GET"===a.method,h="cache"in a?a.cache:!0,i=/^blob:/.test(a.url);if(!i&&(g||!h)){var j=-1!==a.url.indexOf("?");a.url+=(j?"&":"?")+"_nonce="+Date.now()}return Yb(a,b)}function $b(a){var b=a.doc&&a.doc._attachments;b&&Object.keys(b).forEach(function(a){var c=b[a];c.data=Ja(c.data,c.content_type)})}function _b(a){return/^_design/.test(a)?"_design/"+encodeURIComponent(a.slice(8)):/^_local/.test(a)?"_local/"+encodeURIComponent(a.slice(7)):encodeURIComponent(a)}function ac(a){return a._attachments&&Object.keys(a._attachments)?yd.all(Object.keys(a._attachments).map(function(b){var c=a._attachments[b];return c.data&&"string"!=typeof c.data?new yd(function(a){La(c.data,a)}).then(function(a){c.data=a}):void 0})):yd.resolve()}function bc(a){var b=J(a);(b.user||b.password)&&(b.auth={username:b.user,password:b.password});var c=b.path.replace(/(^\/|\/$)/g,"").split("/");return b.db=c.pop(),-1===b.db.indexOf("%")&&(b.db=encodeURIComponent(b.db)),b.path=c.join("/"),b}function cc(a,b){return dc(a,a.db+"/"+b)}function dc(a,b){var c=a.path?"/":"";return a.protocol+"://"+a.host+(a.port?":"+a.port:"")+"/"+a.path+c+b}function ec(a){return"?"+Object.keys(a).map(function(b){return b+"="+encodeURIComponent(a[b])}).join("&")}function fc(a,b){function c(a,b,c){var d=a.ajax||{},e=nd.extend(j(o),d,b);return Ze(e.method+" "+e.url),h._ajax(e,c)}function d(a,b){return new yd(function(d,e){c(a,b,function(a,b){return a?e(a):void d(b)})})}function e(a,b){return m(a,sd(function(a){f().then(function(){return b.apply(this,a)})["catch"](function(b){var c=a.pop();c(b)})}))}function f(){if(a.skipSetup||a.skip_setup)return yd.resolve();if(t)return t;var b={method:"GET",url:l};return t=d({},b)["catch"](function(a){return a&&a.status&&404===a.status?(y(404,"PouchDB is just detecting if the remote exists."),d({},{method:"PUT",url:l})):yd.reject(a)})["catch"](function(a){return a&&a.status&&412===a.status?!0:yd.reject(a)}),t["catch"](function(){t=null}),t}function g(a){return a.split("/").map(encodeURIComponent).join("/")}var h=this,i=bc;a.getHost&&(i=a.getHost);var k=i(a.name,a),l=cc(k,"");a=j(a);var o=a.ajax||{};if(h.getUrl=function(){return l},h.getHeaders=function(){return o.headers||{}},a.auth||k.auth){var p=a.auth||k.auth,r=p.username+":"+p.password,s=ne(unescape(encodeURIComponent(r)));o.headers=o.headers||{},o.headers.Authorization="Basic "+s}h._ajax=Zb;var t;setTimeout(function(){b(null,h)}),h.type=function(){return"http"},h.id=e("id",function(a){c({},{method:"GET",url:dc(k,"")},function(b,c){var d=c&&c.uuid?c.uuid+k.db:cc(k,"");a(null,d)})}),h.request=e("request",function(a,b){a.url=cc(k,a.url),c({},a,b)}),h.compact=e("compact",function(a,b){"function"==typeof a&&(b=a,a={}),a=j(a),c(a,{url:cc(k,"_compact"),method:"POST"},function(){function c(){h.info(function(d,e){e&&!e.compact_running?b(null,{ok:!0}):setTimeout(c,a.interval||200)})}c()})}),h.bulkGet=m("bulkGet",function(a,b){function d(b){var d={};a.revs&&(d.revs=!0),a.attachments&&(d.attachments=!0),c({},{url:cc(k,"_bulk_get"+ec(d)),method:"POST",body:{docs:a.docs}},b)}function e(){function c(a){return function(c,d){h[a]=d.results,++g===e&&b(null,{results:E(h)})}}for(var d=We,e=Math.ceil(a.docs.length/d),g=0,h=new Array(e),i=0;e>i;i++){var j=n(a,["revs","attachments"]);j.ajax=o,j.docs=a.docs.slice(i*d,Math.min(a.docs.length,(i+1)*d)),q(f,j,c(i))}}var f=this,g=dc(k,""),h=Xe[g];"boolean"!=typeof h?d(function(a,c){if(a){var d=Math.floor(a.status/100);4===d||5===d?(Xe[g]=!1,y(a.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),e()):b(a)}else Xe[g]=!0,b(null,c)}):h?d(b):e()}),h._info=function(a){f().then(function(){c({},{method:"GET",url:cc(k,"")},function(b,c){return b?a(b):(c.host=cc(k,""),void a(null,c))})})["catch"](a)},h.get=e("get",function(a,b,c){function e(a){var c=a._attachments,e=c&&Object.keys(c);return c&&e.length?yd.all(e.map(function(e){var f=c[e],h=_b(a._id)+"/"+g(e)+"?rev="+a._rev;return d(b,{method:"GET",url:cc(k,h),binary:!0}).then(function(a){return b.binary?a:new yd(function(b){La(a,b)})}).then(function(a){delete f.stub,delete f.length,f.data=a})})):void 0}function f(a){return Array.isArray(a)?yd.all(a.map(function(a){return a.ok?e(a.ok):void 0})):e(a)}"function"==typeof b&&(c=b,b={}),b=j(b);var h={};b.revs&&(h.revs=!0),b.revs_info&&(h.revs_info=!0),b.open_revs&&("all"!==b.open_revs&&(b.open_revs=JSON.stringify(b.open_revs)),h.open_revs=b.open_revs),b.rev&&(h.rev=b.rev),b.conflicts&&(h.conflicts=b.conflicts),a=_b(a);var i={method:"GET",url:cc(k,a+ec(h))};d(b,i).then(function(a){return yd.resolve().then(function(){return b.attachments?f(a):void 0}).then(function(){c(null,a)})})["catch"](c)}),h.remove=e("remove",function(a,b,d,e){var f;"string"==typeof b?(f={_id:a,_rev:b},"function"==typeof d&&(e=d,d={})):(f=a,"function"==typeof b?(e=b,d={}):(e=d,d=b));var g=f._rev||d.rev;c(d,{method:"DELETE",url:cc(k,_b(f._id))+"?rev="+g},e)}),h.getAttachment=e("getAttachment",function(a,b,d,e){"function"==typeof d&&(e=d,d={});var f=d.rev?"?rev="+d.rev:"",h=cc(k,_b(a))+"/"+g(b)+f;c(d,{method:"GET",url:h,binary:!0},e)}),h.removeAttachment=e("removeAttachment",function(a,b,d,e){var f=cc(k,_b(a)+"/"+g(b))+"?rev="+d;c({},{method:"DELETE",url:f},e)}),h.putAttachment=e("putAttachment",function(a,b,d,e,f,h){"function"==typeof f&&(h=f,f=e,e=d,d=null);var i=_b(a)+"/"+g(b),j=cc(k,i);if(d&&(j+="?rev="+d),"string"==typeof e){var l;try{l=me(e)}catch(m){return h(A(Nd,"Attachment is not a valid base64 string"))}e=l?Ia(l,f):""}var n={headers:{"Content-Type":f},method:"PUT",url:j,processData:!1,body:e,timeout:o.timeout||6e4};c({},n,h)}),h._bulkDocs=function(a,b,d){a.new_edits=b.new_edits,f().then(function(){return yd.all(a.docs.map(ac))}).then(function(){c(b,{method:"POST",url:cc(k,"_bulk_docs"),body:a},function(a,b){return a?d(a):(b.forEach(function(a){a.ok=!0}),void d(null,b))})})["catch"](d)},h.allDocs=e("allDocs",function(a,b){"function"==typeof a&&(b=a,a={}),a=j(a);var c,e={},f="GET";a.conflicts&&(e.conflicts=!0),a.descending&&(e.descending=!0),a.include_docs&&(e.include_docs=!0),a.attachments&&(e.attachments=!0),a.key&&(e.key=JSON.stringify(a.key)),a.start_key&&(a.startkey=a.start_key),a.startkey&&(e.startkey=JSON.stringify(a.startkey)),a.end_key&&(a.endkey=a.end_key),a.endkey&&(e.endkey=JSON.stringify(a.endkey)),"undefined"!=typeof a.inclusive_end&&(e.inclusive_end=!!a.inclusive_end),"undefined"!=typeof a.limit&&(e.limit=a.limit),"undefined"!=typeof a.skip&&(e.skip=a.skip);var g=ec(e);if("undefined"!=typeof a.keys){var h="keys="+encodeURIComponent(JSON.stringify(a.keys));h.length+g.length+1<=Ye?g+="&"+h:(f="POST",c={keys:a.keys})}d(a,{method:f,url:cc(k,"_all_docs"+g),body:c}).then(function(c){a.include_docs&&a.attachments&&a.binary&&c.rows.forEach($b),b(null,c)})["catch"](b)}),h._changes=function(a){var b="batch_size"in a?a.batch_size:Ve;a=j(a),a.timeout="timeout"in a?a.timeout:"timeout"in o?o.timeout:3e4;var d,e=a.timeout?{timeout:a.timeout-5e3}:{},g="undefined"!=typeof a.limit?a.limit:!1;d="return_docs"in a?a.return_docs:"returnDocs"in a?a.returnDocs:!0;var h=g;if(a.style&&(e.style=a.style),(a.include_docs||a.filter&&"function"==typeof a.filter)&&(e.include_docs=!0),a.attachments&&(e.attachments=!0),a.continuous&&(e.feed="longpoll"),a.conflicts&&(e.conflicts=!0),a.descending&&(e.descending=!0),"heartbeat"in a?a.heartbeat&&(e.heartbeat=a.heartbeat):e.heartbeat=1e4,a.filter&&"string"==typeof a.filter&&(e.filter=a.filter),a.view&&"string"==typeof a.view&&(e.filter="_view",e.view=a.view),a.query_params&&"object"==typeof a.query_params)for(var i in a.query_params)a.query_params.hasOwnProperty(i)&&(e[i]=a.query_params[i]);var l,m="GET";if(a.doc_ids){e.filter="_doc_ids";var n=JSON.stringify(a.doc_ids);n.length<Ye?e.doc_ids=n:(m="POST",l={doc_ids:a.doc_ids})}var p,q,r=function(d,i){if(!a.aborted){e.since=d,"object"==typeof e.since&&(e.since=JSON.stringify(e.since)),a.descending?g&&(e.limit=h):e.limit=!g||h>b?b:h;var j={method:m,url:cc(k,"_changes"+ec(e)),timeout:a.timeout,body:l};q=d,a.aborted||f().then(function(){p=c(a,j,i)})["catch"](i)}},s={results:[]},t=function(c,e){if(!a.aborted){var f=0;if(e&&e.results){f=e.results.length,s.last_seq=e.last_seq;var i={};i.query=a.query_params,e.results=e.results.filter(function(b){h--;var c=D(a)(b);return c&&(a.include_docs&&a.attachments&&a.binary&&$b(b),d&&s.results.push(b),a.onChange(b)),c})}else if(c)return a.aborted=!0,void a.complete(c);e&&e.last_seq&&(q=e.last_seq);var j=g&&0>=h||e&&b>f||a.descending;(!a.continuous||g&&0>=h)&&j?a.complete(null,s):setTimeout(function(){r(q,t)},0)}};return r(a.since||0,t),{cancel:function(){a.aborted=!0,p&&p.abort()}}},h.revsDiff=e("revsDiff",function(a,b,d){"function"==typeof b&&(d=b,b={}),c(b,{method:"POST",url:cc(k,"_revs_diff"),body:a},d)}),h._close=function(a){a()},h._destroy=function(a,b){c(a,{url:cc(k,""),method:"DELETE"},function(a,c){return a&&a.status&&404!==a.status?b(a):void b(null,c)})}}function gc(a){a.adapter("http",fc,!1),a.adapter("https",fc,!1)}function hc(){this.promise=new yd(function(a){a()})}function ic(a){var b=a.db,c=a.viewName,d=a.map,e=a.reduce,f=a.temporary,g=d.toString()+(e&&e.toString())+"undefined";if(!f&&b._cachedViews){var h=b._cachedViews[g];if(h)return yd.resolve(h)}return b.info().then(function(a){function h(a){a.views=a.views||{};var b=c;-1===b.indexOf("/")&&(b=c+"/"+c);var d=a.views[b]=a.views[b]||{};if(!d[i])return d[i]=!0,a}var i=a.db_name+"-mrview-"+(f?"temp":Ra(g));return K(b,"_local/mrviews",h).then(function(){return b.registerDependentDatabase(i).then(function(a){var c=a.db;c.auto_compaction=!0;var h={name:i,db:c,sourceDB:b,adapter:b.adapter,mapFun:d,reduceFun:e};return h.db.get("_local/lastSeq")["catch"](function(a){if(404!==a.status)throw a}).then(function(a){return h.seq=a?a.seq:0,f||(b._cachedViews=b._cachedViews||{},b._cachedViews[g]=h,h.db.once("destroyed",function(){delete b._cachedViews[g]})),h})})})})}function jc(a,b,c,d,e,f){return ud("return ("+a.replace(/;\s*$/,"")+");",{emit:b,sum:c,log:d,isArray:e,toJSON:f})}function kc(a){return-1===a.indexOf("/")?[a,a]:a.split("/")}function lc(a){return 1===a.length&&/^1-/.test(a[0].rev)}function mc(a,b){try{a.emit("error",b)}catch(c){v("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),v("error",b)}}function nc(a,b,c){try{return{output:b.apply(null,c)}}catch(d){return mc(a,d),{error:d}}}function oc(a,b){var c=xd.collate(a.key,b.key);return 0!==c?c:xd.collate(a.value,b.value)}function pc(a,b,c){return c=c||0,"number"==typeof b?a.slice(c,b+c):c>0?a.slice(c):a}function qc(a){var b=a.value,c=b&&"object"==typeof b&&b._id||a.id;return c}function rc(a){a.rows.forEach(function(a){var b=a.doc&&a.doc._attachments;b&&Object.keys(b).forEach(function(a){var c=b[a];b[a].data=Ja(c.data,c.content_type)})})}function sc(a){return function(b){return a.include_docs&&a.attachments&&a.binary&&rc(b),b}}function tc(a){var b="builtin "+a+" function requires map values to be numbers or number arrays";return new Rc(b)}function uc(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];if("number"!=typeof e){if(!Array.isArray(e))throw tc("_sum");b="number"==typeof b?[b]:b;for(var f=0,g=e.length;g>f;f++){var h=e[f];if("number"!=typeof h)throw tc("_sum");"undefined"==typeof b[f]?b.push(h):b[f]+=h}}else"number"==typeof b?b+=e:b[0]+=e}return b}function vc(a,b,c,d){var e=b[a];"undefined"!=typeof e&&(d&&(e=encodeURIComponent(JSON.stringify(e))),c.push(a+"="+e))}function wc(a){if("undefined"!=typeof a){var b=Number(a);return isNaN(b)||b!==parseInt(a,10)?a:b}}function xc(a){return a.group_level=wc(a.group_level),a.limit=wc(a.limit),a.skip=wc(a.skip),a}function yc(a){if(a){if("number"!=typeof a)return new Pc('Invalid value for integer: "'+a+'"');if(0>a)return new Pc('Invalid value for positive integer: "'+a+'"')}}function zc(a,b){var c=a.descending?"endkey":"startkey",d=a.descending?"startkey":"endkey";if("undefined"!=typeof a[c]&&"undefined"!=typeof a[d]&&xd.collate(a[c],a[d])>0)throw new Pc("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(b.reduce&&a.reduce!==!1){if(a.include_docs)throw new Pc("{include_docs:true} is invalid for reduce");if(a.keys&&a.keys.length>1&&!a.group&&!a.group_level)throw new Pc("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(b){var c=yc(a[b]);if(c)throw c})}function Ac(a,b,c){var d,e=[],f="GET";if(vc("reduce",c,e),vc("include_docs",c,e),vc("attachments",c,e),vc("limit",c,e),vc("descending",c,e),vc("group",c,e),vc("group_level",c,e),vc("skip",c,e),vc("stale",c,e),vc("conflicts",c,e),vc("startkey",c,e,!0),vc("start_key",c,e,!0),vc("endkey",c,e,!0),vc("end_key",c,e,!0),vc("inclusive_end",c,e),vc("key",c,e,!0),e=e.join("&"),e=""===e?"":"?"+e,"undefined"!=typeof c.keys){var g=2e3,h="keys="+encodeURIComponent(JSON.stringify(c.keys));h.length+e.length+1<=g?e+=("?"===e[0]?"&":"?")+h:(f="POST","string"==typeof b?d={keys:c.keys}:b.keys=c.keys)}if("string"==typeof b){var i=kc(b);return a.request({method:f,url:"_design/"+i[0]+"/_view/"+i[1]+e,body:d}).then(sc(c))}return d=d||{},Object.keys(b).forEach(function(a){Array.isArray(b[a])?d[a]=b[a]:d[a]=b[a].toString()}),a.request({method:"POST",url:"_temp_view"+e,body:d}).then(sc(c))}function Bc(a,b,c){return new yd(function(d,e){a._query(b,c,function(a,b){return a?e(a):void d(b)})})}function Cc(a){return new yd(function(b,c){a._viewCleanup(function(a,d){return a?c(a):void b(d)})})}function Dc(a){return function(b){if(404===b.status)return a;throw b}}function Ec(a,b,c){function d(){return lc(k)?yd.resolve(h):b.db.get(g)["catch"](Dc(h))}function e(a){return a.keys.length?b.db.allDocs({keys:a.keys,include_docs:!0}):yd.resolve({rows:[]})}function f(a,b){for(var c=[],d={},e=0,f=b.rows.length;f>e;e++){var g=b.rows[e],h=g.doc;if(h&&(c.push(h),d[h._id]=!0,h._deleted=!j[h._id],!h._deleted)){var i=j[h._id];"value"in i&&(h.value=i.value)}}var k=Object.keys(j);return k.forEach(function(a){if(!d[a]){var b={_id:a},e=j[a];"value"in e&&(b.value=e.value),c.push(b)}}),a.keys=cf(k.concat(a.keys)),c.push(a),c}var g="_local/doc_"+a,h={_id:g,keys:[]},i=c[a],j=i.indexableKeysToKeyValues,k=i.changes;return d().then(function(a){return e(a).then(function(b){return f(a,b)})})}function Fc(a,b,c){var d="_local/lastSeq";return a.db.get(d)["catch"](Dc({_id:d,seq:0})).then(function(d){var e=Object.keys(b);return yd.all(e.map(function(c){return Ec(c,a,b)})).then(function(b){var e=E(b);return d.seq=c,e.push(d),a.db.bulkDocs({docs:e})})})}function Gc(a){var b="string"==typeof a?a:a.name,c=df[b];return c||(c=df[b]=new hc),c}function Hc(a){return bf(Gc(a),function(){return Ic(a)})()}function Ic(a){function b(a,b){var c={id:e._id,key:xd.normalizeKey(a)};"undefined"!=typeof b&&null!==b&&(c.value=xd.normalizeKey(b)),d.push(c)}function c(b,c){return function(){return Fc(a,b,c)}}var d,e,f;if("function"==typeof a.mapFun&&2===a.mapFun.length){var g=a.mapFun;f=function(a){return g(a,b)}}else f=jc(a.mapFun.toString(),b,uc,gf,Array.isArray,JSON.parse);var h=a.seq||0,i=new hc;return new yd(function(b,g){function j(){i.finish().then(function(){a.seq=h,b()})}function k(){function b(a){g(a)}a.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:h,limit:ff}).on("complete",function(b){var g=b.results;if(!g.length)return j();for(var l={},m=0,n=g.length;n>m;m++){var o=g[m];if("_"!==o.doc._id[0]){d=[],e=o.doc,e._deleted||nc(a.sourceDB,f,[e]),d.sort(oc);for(var p,q={},r=0,s=d.length;s>r;r++){var t=d[r],u=[t.key,t.id];0===xd.collate(t.key,p)&&u.push(r);var v=xd.toIndexableString(u);q[v]=t,p=t.key}l[o.doc._id]={indexableKeysToKeyValues:q,changes:o.changes}}h=o.seq}return i.add(c(l,h)),g.length<ff?j():k()}).on("error",b)}k()})}function Jc(a,b,c){0===c.group_level&&delete c.group_level;var d,e=c.group||c.group_level;d=hf[a.reduceFun]?hf[a.reduceFun]:jc(a.reduceFun.toString(),null,uc,gf,Array.isArray,JSON.parse);var f=[],g=isNaN(c.group_level)?Number.POSITIVE_INFINITY:c.group_level;b.forEach(function(a){var b=f[f.length-1],c=e?a.key:null;return e&&Array.isArray(c)&&(c=c.slice(0,g)),b&&0===xd.collate(b.groupKey,c)?(b.keys.push([a.key,a.id]),void b.values.push(a.value)):void f.push({keys:[[a.key,a.id]],values:[a.value],groupKey:c})}),b=[];for(var h=0,i=f.length;i>h;h++){var j=f[h],k=nc(a.sourceDB,d,[j.keys,j.values,!1]);if(k.error&&k.error instanceof Rc)throw k.error;b.push({value:k.error?null:k.output,key:j.groupKey})}return{rows:pc(b,c.limit,c.skip)}}function Kc(a,b){return bf(Gc(a),function(){return Lc(a,b)})()}function Lc(a,b){function c(b){return b.include_docs=!0,a.db.allDocs(b).then(function(a){return e=a.total_rows,a.rows.map(function(a){if("value"in a.doc&&"object"==typeof a.doc.value&&null!==a.doc.value){var b=Object.keys(a.doc.value).sort(),c=["id","key","value"];if(!(c>b||b>c))return a.doc.value}var d=xd.parseIndexableString(a.doc._id);return{key:d[0],id:d[1],value:"value"in a.doc?a.doc.value:null}})})}function d(c){var d;if(d=f?Jc(a,c,b):{total_rows:e,offset:g,rows:c},b.include_docs){var h=cf(c.map(qc));return a.sourceDB.allDocs({keys:h,include_docs:!0,conflicts:b.conflicts,attachments:b.attachments,binary:b.binary}).then(function(a){var b={};return a.rows.forEach(function(a){a.doc&&(b["$"+a.id]=a.doc)}),c.forEach(function(a){var c=qc(a),d=b["$"+c];d&&(a.doc=d)}),d})}return d}var e,f=a.reduceFun&&b.reduce!==!1,g=b.skip||0;if("undefined"==typeof b.keys||b.keys.length||(b.limit=0,delete b.keys),"undefined"!=typeof b.keys){var h=b.keys,i=h.map(function(a){var b={startkey:xd.toIndexableString([a]),endkey:xd.toIndexableString([a,{}])};return c(b)});return yd.all(i).then(E).then(d)}var j={descending:b.descending};if(b.start_key&&(b.startkey=b.start_key),b.end_key&&(b.endkey=b.end_key),"undefined"!=typeof b.startkey&&(j.startkey=b.descending?xd.toIndexableString([b.startkey,{}]):xd.toIndexableString([b.startkey])),"undefined"!=typeof b.endkey){var k=b.inclusive_end!==!1;b.descending&&(k=!k),j.endkey=xd.toIndexableString(k?[b.endkey,{}]:[b.endkey])}if("undefined"!=typeof b.key){var l=xd.toIndexableString([b.key]),m=xd.toIndexableString([b.key,{}]);j.descending?(j.endkey=l,j.startkey=m):(j.startkey=l,j.endkey=m)}return f||("number"==typeof b.limit&&(j.limit=b.limit),j.skip=g),c(j).then(d)}function Mc(a){return a.request({method:"POST",url:"_view_cleanup"})}function Nc(a){return a.get("_local/mrviews").then(function(b){var c={};Object.keys(b.views).forEach(function(a){var b=kc(a),d="_design/"+b[0],e=b[1];c[d]=c[d]||{},c[d][e]=!0});var d={keys:Object.keys(c),include_docs:!0};return a.allDocs(d).then(function(d){var e={};d.rows.forEach(function(a){var d=a.key.substring(8);Object.keys(c[a.key]).forEach(function(c){var f=d+"/"+c;b.views[f]||(f=c);var g=Object.keys(b.views[f]),h=a.doc&&a.doc.views&&a.doc.views[c];g.forEach(function(a){e[a]=e[a]||h})})});var f=Object.keys(e).filter(function(a){return!e[a]}),g=f.map(function(b){return bf(Gc(b),function(){return new a.constructor(b,a.__opts).destroy()})()});return yd.all(g).then(function(){return{ok:!0}})})},Dc({ok:!0}))}function Oc(a,b,d){if("http"===a.type())return Ac(a,b,d);if("function"==typeof a._query)return Bc(a,b,d);if("string"!=typeof b){zc(d,b);var e={db:a,viewName:"temp_view/temp_view",map:b.map,reduce:b.reduce,temporary:!0};return ef.add(function(){return ic(e).then(function(a){function b(){return a.db.destroy()}return af(Hc(a).then(function(){return Kc(a,d)}),b)})}),ef.finish()}var f=b,g=kc(f),h=g[0],i=g[1];return a.get("_design/"+h).then(function(b){var e=b.views&&b.views[i];if(!e||"string"!=typeof e.map)throw new Qc("ddoc "+h+" has no view named "+i);zc(d,e);var g={db:a,viewName:f,map:e.map,reduce:e.reduce};return ic(g).then(function(a){return"ok"===d.stale||"update_after"===d.stale?("update_after"===d.stale&&c.nextTick(function(){Hc(a)}),Kc(a,d)):Hc(a).then(function(){return Kc(a,d)})})})}function Pc(a){this.status=400,this.name="query_parse_error",this.message=a,this.error=!0;try{Error.captureStackTrace(this,Pc)}catch(b){}}function Qc(a){this.status=404,this.name="not_found",this.message=a,this.error=!0;try{Error.captureStackTrace(this,Qc)}catch(b){}}function Rc(a){this.status=500,this.name="invalid_value",this.message=a,this.error=!0;try{Error.captureStackTrace(this,Rc)}catch(b){}}function Sc(a){return/^1-/.test(a)}function Tc(a,b,c){return!a._attachments||!a._attachments[c]||a._attachments[c].digest!==b._attachments[c].digest}function Uc(a,b){var c=Object.keys(b._attachments);return yd.all(c.map(function(c){return a.getAttachment(b._id,c,{rev:b._rev})}))}function Vc(a,b,c){var d="http"===b.type()&&"http"!==a.type(),e=Object.keys(c._attachments);return d?a.get(c._id).then(function(d){return yd.all(e.map(function(e){return Tc(d,c,e)?b.getAttachment(c._id,e):a.getAttachment(d._id,e)}))})["catch"](function(a){if(404!==a.status)throw a;return Uc(b,c)}):Uc(b,c)}function Wc(a){var b=[];return Object.keys(a).forEach(function(c){var d=a[c].missing;d.forEach(function(a){b.push({id:c,rev:a})})}),{docs:b,revs:!0}}function Xc(a,b,c,d){function e(){var e=Wc(c);if(e.docs.length)return a.bulkGet(e).then(function(c){if(d.cancelled)throw new Error("cancelled");return yd.all(c.results.map(function(c){return yd.all(c.docs.map(function(c){var d=c.ok;return c.error&&(l=!1),d&&d._attachments?Vc(b,a,d).then(function(a){var b=Object.keys(d._attachments);return a.forEach(function(a,c){var e=d._attachments[b[c]];delete e.stub,delete e.length,e.data=a}),d}):d}))})).then(function(a){k=k.concat(E(a).filter(Boolean))})})}function f(a){return a._attachments&&Object.keys(a._attachments).length>0}function g(b){return a.allDocs({keys:b,include_docs:!0}).then(function(a){if(d.cancelled)throw new Error("cancelled");a.rows.forEach(function(a){!a.deleted&&a.doc&&Sc(a.value.rev)&&!f(a.doc)&&(k.push(a.doc),delete c[a.id])})})}function h(){var a=Object.keys(c).filter(function(a){var b=c[a].missing;return 1===b.length&&Sc(b[0])});return a.length>0?g(a):void 0}function i(){return{ok:l,docs:k}}c=j(c);var k=[],l=!0;return yd.resolve().then(h).then(e).then(i)}function Yc(a,b,c,d,e){return a.get(b)["catch"](function(c){if(404===c.status)return"http"===a.type()&&y(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:d,_id:b,history:[],replicator:nf,version:mf};throw c}).then(function(f){return e.cancelled?void 0:(f.history=(f.history||[]).filter(function(a){
return a.session_id!==d}),f.history.unshift({last_seq:c,session_id:d}),f.history=f.history.slice(0,of),f.version=mf,f.replicator=nf,f.session_id=d,f.last_seq=c,a.put(f)["catch"](function(f){if(409===f.status)return Yc(a,b,c,d,e);throw f}))})}function Zc(a,b,c,d){this.src=a,this.target=b,this.id=c,this.returnValue=d}function $c(a,b){return a.session_id===b.session_id?{last_seq:a.last_seq,history:a.history}:_c(a.history,b.history)}function _c(a,b){var c=a[0],d=a.slice(1),e=b[0],f=b.slice(1);if(!c||0===b.length)return{last_seq:pf,history:[]};var g=c.session_id;if(ad(g,b))return{last_seq:c.last_seq,history:a};var h=e.session_id;return ad(h,d)?{last_seq:e.last_seq,history:f}:_c(d,f)}function ad(a,b){var c=b[0],d=b.slice(1);return a&&0!==b.length?a===c.session_id?!0:ad(a,d):!1}function bd(a){return"number"==typeof a.status&&4===Math.floor(a.status/100)}function cd(a,b,c,d){return a.retry===!1?(b.emit("error",c),void b.removeAllListeners()):("function"!=typeof a.back_off_function&&(a.back_off_function=x),b.emit("requestError",c),"active"!==b.state&&"pending"!==b.state||(b.emit("paused",c),b.state="stopped",b.once("active",function(){a.current_back_off=rf})),a.current_back_off=a.current_back_off||rf,a.current_back_off=a.back_off_function(a.current_back_off),void setTimeout(d,a.current_back_off))}function dd(a){return Object.keys(a).sort(xd.collate).reduce(function(b,c){return b[c]=a[c],b},{})}function ed(a,b,c){var d=c.doc_ids?c.doc_ids.sort(xd.collate):"",e=c.filter?c.filter.toString():"",f="",g="";return c.filter&&c.query_params&&(f=JSON.stringify(dd(c.query_params))),c.filter&&"_view"===c.filter&&(g=c.view.toString()),yd.all([a.id(),b.id()]).then(function(a){var b=a[0]+a[1]+e+g+f+d;return new yd(function(a){Qa(b,a)})}).then(function(a){return a=a.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+a})}function fd(a,b,c,d,e){function f(){return x?yd.resolve():ed(a,b,c).then(function(c){w=c,x=new Zc(a,b,w,d)})}function g(){if(L=[],0!==v.docs.length){var a=v.docs;return b.bulkDocs({docs:a,new_edits:!1}).then(function(b){if(d.cancelled)throw o(),new Error("cancelled");var c=[],f={};b.forEach(function(a){a.error&&(e.doc_write_failures++,c.push(a),f[a.id]=a)}),K=K.concat(c),e.docs_written+=v.docs.length-c.length;var g=c.filter(function(a){return"unauthorized"!==a.name&&"forbidden"!==a.name});if(a.forEach(function(a){var b=f[a._id];b?d.emit("denied",j(b)):L.push(a)}),g.length>0){var h=new Error("bulkDocs error");throw h.other_errors=c,n("target.bulkDocs failed to write docs",h),new Error("bulkWrite partial failure")}},function(b){throw e.doc_write_failures+=a.length,b})}}function h(){if(v.error)throw new Error("There was a problem getting docs.");e.last_seq=E=v.seq;var a=j(e);return L.length&&(a.docs=L,d.emit("change",a)),A=!0,x.writeCheckpoint(v.seq,M).then(function(){if(A=!1,d.cancelled)throw o(),new Error("cancelled");v=void 0,s()})["catch"](u)}function i(){var a={};return v.changes.forEach(function(b){"_user/"!==b.id&&(a[b.id]=b.changes.map(function(a){return a.rev}))}),b.revsDiff(a).then(function(a){if(d.cancelled)throw o(),new Error("cancelled");v.diffs=a})}function k(){return Xc(a,b,v.diffs,d).then(function(a){v.error=!a.ok,a.docs.forEach(function(a){delete v.diffs[a._id],e.docs_read++,v.docs.push(a)})})}function l(){if(!d.cancelled&&!v){if(0===y.length)return void m(!0);v=y.shift(),i().then(k).then(g).then(h).then(l)["catch"](function(a){n("batch processing terminated with error",a)})}}function m(a){return 0===z.changes.length?void(0!==y.length||v||((F&&O.live||B)&&(d.state="pending",d.emit("paused")),B&&o())):void((a||B||z.changes.length>=G)&&(y.push(z),z={seq:0,changes:[],docs:[]},"pending"!==d.state&&"stopped"!==d.state||(d.state="active",d.emit("active")),l()))}function n(a,b){C||(b.message||(b.message=a),e.ok=!1,e.status="aborting",e.errors.push(b),K=K.concat(b),y=[],z={seq:0,changes:[],docs:[]},o())}function o(){if(!(C||d.cancelled&&(e.status="cancelled",A))){e.status=e.status||"complete",e.end_time=new Date,e.last_seq=E,C=!0;var f=K.filter(function(a){return"unauthorized"!==a.name&&"forbidden"!==a.name});if(f.length>0){var g=K.pop();K.length>0&&(g.other_errors=K),g.result=e,cd(c,d,g,function(){fd(a,b,c,d)})}else e.errors=K,d.emit("complete",e),d.removeAllListeners()}}function p(a){if(d.cancelled)return o();var b=D(c)(a);b&&(z.seq=a.seq,z.changes.push(a),m(0===y.length&&O.live))}function q(a){if(I=!1,d.cancelled)return o();if(a.results.length>0)O.since=a.last_seq,s(),m(!0);else{var b=function(){F?(O.live=!0,s()):B=!0,m(!0)};v||0!==a.results.length?b():(A=!0,x.writeCheckpoint(a.last_seq,M).then(function(){A=!1,e.last_seq=E=a.last_seq,b()})["catch"](u))}}function r(a){return I=!1,d.cancelled?o():void n("changes rejected",a)}function s(){function b(){f.cancel()}function e(){d.removeListener("cancel",b)}if(!I&&!B&&y.length<H){I=!0,d._changes&&(d.removeListener("cancel",d._abortChanges),d._changes.cancel()),d.once("cancel",b);var f=a.changes(O).on("change",p);f.then(e,e),f.then(q)["catch"](r),c.retry&&(d._changes=f,d._abortChanges=b)}}function t(){f().then(function(){return d.cancelled?void o():x.getCheckpoint().then(function(a){E=a,O={since:E,limit:G,batch_size:G,style:"all_docs",doc_ids:J,return_docs:!0},c.filter&&("string"!=typeof c.filter?O.include_docs=!0:O.filter=c.filter),"heartbeat"in c&&(O.heartbeat=c.heartbeat),"timeout"in c&&(O.timeout=c.timeout),c.query_params&&(O.query_params=c.query_params),c.view&&(O.view=c.view),s()})})["catch"](function(a){n("getCheckpoint rejected with ",a)})}function u(a){throw A=!1,n("writeCheckpoint completed with error",a),a}var v,w,x,y=[],z={seq:0,changes:[],docs:[]},A=!1,B=!1,C=!1,E=0,F=c.continuous||c.live||!1,G=c.batch_size||100,H=c.batches_limit||10,I=!1,J=c.doc_ids,K=[],L=[],M=N();e=e||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var O={};return d.ready(a,b),d.cancelled?void o():(d._addedListeners||(d.once("cancel",o),"function"==typeof c.complete&&(d.once("error",c.complete),d.once("complete",function(a){c.complete(null,a)})),d._addedListeners=!0),void("undefined"==typeof c.since?t():f().then(function(){return A=!0,x.writeCheckpoint(c.since,M)}).then(function(){return A=!1,d.cancelled?void o():(E=c.since,void t())})["catch"](u)))}function gd(){td.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var a=this,b=new yd(function(b,c){a.once("complete",b),a.once("error",c)});a.then=function(a,c){return b.then(a,c)},a["catch"]=function(a){return b["catch"](a)},a["catch"](function(){})}function hd(a,b){var c=b.PouchConstructor;return"string"==typeof a?new c(a,b):a}function id(a,b,c,d){if("function"==typeof c&&(d=c,c={}),"undefined"==typeof c&&(c={}),c.doc_ids&&!Array.isArray(c.doc_ids))throw A(Rd,"`doc_ids` filter parameter is not a list.");c.complete=d,c=j(c),c.continuous=c.continuous||c.live,c.retry="retry"in c?c.retry:!1,c.PouchConstructor=c.PouchConstructor||this;var e=new gd(c),f=hd(a,c),g=hd(b,c);return fd(f,g,c,e),e}function jd(a,b,c,d){return"function"==typeof c&&(d=c,c={}),"undefined"==typeof c&&(c={}),c=j(c),c.PouchConstructor=c.PouchConstructor||this,a=hd(a,c),b=hd(b,c),new kd(a,b,c,d)}function kd(a,b,c,d){function e(a){n.emit("change",{direction:"pull",change:a})}function f(a){n.emit("change",{direction:"push",change:a})}function g(a){n.emit("denied",{direction:"push",doc:a})}function h(a){n.emit("denied",{direction:"pull",doc:a})}function i(){n.pushPaused=!0,n.pullPaused&&n.emit("paused")}function j(){n.pullPaused=!0,n.pushPaused&&n.emit("paused")}function k(){n.pushPaused=!1,n.pullPaused&&n.emit("active",{direction:"push"})}function l(){n.pullPaused=!1,n.pushPaused&&n.emit("active",{direction:"pull"})}function m(a){return function(b,c){var d="change"===b&&(c===e||c===f),m="denied"===b&&(c===h||c===g),o="paused"===b&&(c===j||c===i),p="active"===b&&(c===l||c===k);(d||m||o||p)&&(b in q||(q[b]={}),q[b][a]=!0,2===Object.keys(q[b]).length&&n.removeAllListeners(b))}}var n=this;this.canceled=!1;var o=c.push?nd.extend({},c,c.push):c,p=c.pull?nd.extend({},c,c.pull):c;this.push=id(a,b,o),this.pull=id(b,a,p),this.pushPaused=!0,this.pullPaused=!0;var q={};c.live&&(this.push.on("complete",n.pull.cancel.bind(n.pull)),this.pull.on("complete",n.push.cancel.bind(n.push))),this.on("newListener",function(a){"change"===a?(n.pull.on("change",e),n.push.on("change",f)):"denied"===a?(n.pull.on("denied",h),n.push.on("denied",g)):"active"===a?(n.pull.on("active",l),n.push.on("active",k)):"paused"===a&&(n.pull.on("paused",j),n.push.on("paused",i))}),this.on("removeListener",function(a){"change"===a?(n.pull.removeListener("change",e),n.push.removeListener("change",f)):"denied"===a?(n.pull.removeListener("denied",h),n.push.removeListener("denied",g)):"active"===a?(n.pull.removeListener("active",l),n.push.removeListener("active",k)):"paused"===a&&(n.pull.removeListener("paused",j),n.push.removeListener("paused",i))}),this.pull.on("removeListener",m("pull")),this.push.on("removeListener",m("push"));var r=yd.all([this.push,this.pull]).then(function(a){var b={push:a[0],pull:a[1]};return n.emit("complete",b),d&&d(null,b),n.removeAllListeners(),b},function(a){if(n.cancel(),d?d(a):n.emit("error",a),n.removeAllListeners(),d)throw a});this.then=function(a,b){return r.then(a,b)},this["catch"]=function(a){return r["catch"](a)}}function ld(a){a.replicate=id,a.sync=jd}var md,nd=a(9),od=e(a(5)),pd=e(a(8)),qd=e(a(10)),rd=a(14),sd=e(a(4)),td=a(1),ud=e(a(15)),vd=e(a(16)),wd=e(a(17)),xd=a(12),yd="function"==typeof Promise?Promise:qd,zd=Function.prototype.toString,Ad=zd.call(Object),Bd=od("pouchdb:api"),Cd=6;if(r())md=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),md=!!localStorage.getItem("_pouch_check_localstorage")}catch(Dd){md=!1}pd(u,td.EventEmitter),u.prototype.addListener=function(a,b,c,d){function e(){function a(){g=!1}if(f._listeners[b]){if(g)return void(g="waiting");g=!0;var h=n(d,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);c.changes(h).on("change",function(a){a.seq>d.since&&!d.cancelled&&(d.since=a.seq,d.onChange(a))}).on("complete",function(){"waiting"===g&&setTimeout(function(){e()},0),g=!1}).on("error",a)}}if(!this._listeners[b]){var f=this,g=!1;this._listeners[b]=e,this.on(a,e)}},u.prototype.removeListener=function(a,b){b in this._listeners&&td.EventEmitter.prototype.removeListener.call(this,a,this._listeners[b])},u.prototype.notifyLocalWindows=function(a){r()?chrome.storage.local.set({dbName:a}):s()&&(localStorage[a]="a"===localStorage[a]?"b":"a")},u.prototype.notify=function(a){this.emit(a),this.notifyLocalWindows(a)},pd(z,Error),z.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var Ed=new z({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),Fd=new z({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),Gd=new z({status:404,error:"not_found",reason:"missing"}),Hd=new z({status:409,error:"conflict",reason:"Document update conflict"}),Id=new z({status:400,error:"invalid_id",reason:"_id field must contain a string"}),Jd=new z({status:412,error:"missing_id",reason:"_id is required for puts"}),Kd=new z({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),Ld=new z({status:412,error:"precondition_failed",reason:"Database not open"}),Md=new z({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),Nd=new z({status:500,error:"badarg",reason:"Some query argument is invalid"}),Od=new z({status:400,error:"invalid_request",reason:"Request was invalid"}),Pd=new z({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),Qd=new z({status:500,error:"doc_validation",reason:"Bad special document member"}),Rd=new z({status:400,error:"bad_request",reason:"Something wrong with the request"}),Sd=new z({status:400,error:"bad_request",reason:"Document must be a JSON object"}),Td=new z({status:404,error:"not_found",reason:"Database not found"}),Ud=new z({status:500,error:"indexed_db_went_bad",reason:"unknown"}),Vd=new z({status:500,error:"web_sql_went_bad",reason:"unknown"}),Wd=new z({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),Xd=new z({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),Yd=new z({status:400,error:"bad_request",reason:"Invalid rev format"}),Zd=new z({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),$d=new z({status:412,error:"missing_stub"}),_d=new z({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),ae=[Ed,Fd,Gd,Hd,Id,Jd,Kd,Ld,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Vd,Wd,Xd,Yd,Zd,$d,Ud,_d],be=function(a,b,c){var d=ae.filter(function(c){return c[a]===b});return c&&d.filter(function(a){return a.message===c})[0]||d[0]},ce=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],de="queryKey",ee=/(?:^|&)([^&=]*)=?([^&]*)/g,fe=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ge="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");pd(ja,td.EventEmitter),ja.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},ja.prototype.doChanges=function(a){var b=this,c=a.complete;if(a=j(a),"live"in a&&!("continuous"in a)&&(a.continuous=a.live),a.processChange=ka,"latest"===a.since&&(a.since="now"),a.since||(a.since=0),"now"===a.since)return void this.db.info().then(function(d){return b.isCancelled?void c(null,{status:"cancelled"}):(a.since=d.update_seq,void b.doChanges(a))},c);if(a.continuous&&"now"!==a.since&&this.db.info().then(function(a){b.startSeq=a.update_seq},function(a){if("idbNull"!==a.id)throw a}),a.view&&!a.filter&&(a.filter="_view"),a.filter&&"string"==typeof a.filter&&("_view"===a.filter?a.view=I(a.view):a.filter=I(a.filter),"http"!==this.db.type()&&!a.doc_ids))return this.filterChanges(a);"descending"in a||(a.descending=!1),a.limit=0===a.limit?1:a.limit,a.complete=c;var d=this.db._changes(a);if(d&&"function"==typeof d.cancel){var e=b.cancel;b.cancel=sd(function(a){d.cancel(),e.apply(this,a)})}},ja.prototype.filterChanges=function(a){var b=this,c=a.complete;if("_view"===a.filter){if(!a.view||"string"!=typeof a.view){var d=A(Rd,"`view` filter parameter not found or invalid.");return c(d)}var e=H(a.view);this.db.get("_design/"+e[0],function(d,f){if(b.isCancelled)return c(null,{status:"cancelled"});if(d)return c(B(d));var g=f&&f.views&&f.views[e[1]]&&f.views[e[1]].map;return g?(a.filter=ha(g),void b.doChanges(a)):c(A(Gd,f.views?"missing json key: "+e[1]:"missing json key: views"))})}else{var f=H(a.filter);if(!f)return b.doChanges(a);this.db.get("_design/"+f[0],function(d,e){if(b.isCancelled)return c(null,{status:"cancelled"});if(d)return c(B(d));var g=e&&e.filters&&e.filters[f[1]];return g?(a.filter=ga(g),void b.doChanges(a)):c(A(Gd,e&&e.filters?"missing json key: "+f[1]:"missing json key: filters"))})}},pd(ua,td.EventEmitter),ua.prototype.post=m("post",function(a,b,c){return"function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a)?c(A(Sd)):void this.bulkDocs({docs:[a]},b,na(c))}),ua.prototype.put=m("put",sd(function(a){function b(){g||(v("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),g=!0)}var c,d,e,f,g=!1,h=a.shift(),i="_id"in h;if("object"!=typeof h||Array.isArray(h))return(f=a.pop())(A(Sd));for(;;)if(c=a.shift(),d=typeof c,"string"!==d||i?"string"!==d||!i||"_rev"in h?"object"===d?e=c:"function"===d&&(f=c):(b(),h._rev=c):(b(),h._id=c,i=!0),!a.length)break;return e=e||{},F(h._id),fa(h._id)&&"function"==typeof this._putLocal?h._deleted?this._removeLocal(h,f):this._putLocal(h,f):void this.bulkDocs({docs:[h]},e,na(f))})),ua.prototype.putAttachment=m("putAttachment",function(a,b,c,d,e){function f(a){var c="_rev"in a?parseInt(a._rev,10):0;return a._attachments=a._attachments||{},a._attachments[b]={content_type:e,data:d,revpos:++c},g.put(a)}var g=this;return"function"==typeof e&&(e=d,d=c,c=null),"undefined"==typeof e&&(e=d,d=c,c=null),g.get(a).then(function(a){if(a._rev!==c)throw A(Hd);return f(a)},function(b){if(b.reason===Gd.message)return f({_id:a});throw b})}),ua.prototype.removeAttachment=m("removeAttachment",function(a,b,c,d){var e=this;e.get(a,function(a,f){return a?void d(a):f._rev!==c?void d(A(Hd)):f._attachments?(delete f._attachments[b],0===Object.keys(f._attachments).length&&delete f._attachments,void e.put(f,d)):d()})}),ua.prototype.remove=m("remove",function(a,b,c,d){var e;"string"==typeof b?(e={_id:a,_rev:b},"function"==typeof c&&(d=c,c={})):(e=a,"function"==typeof b?(d=b,c={}):(d=c,c=b)),c=c||{},c.was_delete=!0;var f={_id:e._id,_rev:e._rev||c.rev};return f._deleted=!0,fa(f._id)&&"function"==typeof this._removeLocal?this._removeLocal(e,d):void this.bulkDocs({docs:[f]},c,na(d))}),ua.prototype.revsDiff=m("revsDiff",function(a,b,c){function d(a,b){h.has(a)||h.set(a,{missing:[]}),h.get(a).missing.push(b)}function e(b,c){var e=a[b].slice(0);P(c,function(a,c,f,g,h){var i=c+"-"+f,j=e.indexOf(i);-1!==j&&(e.splice(j,1),"available"!==h.status&&d(b,i))}),e.forEach(function(a){d(b,a)})}"function"==typeof b&&(c=b,b={});var f=Object.keys(a);if(!f.length)return c(null,{});var g=0,h=new rd.Map;f.map(function(b){this._getRevisionTree(b,function(d,i){if(d&&404===d.status&&"missing"===d.message)h.set(b,{missing:a[b]});else{if(d)return c(d);e(b,i)}if(++g===f.length){var j={};return h.forEach(function(a,b){j[b]=a}),c(null,j)}})},this)}),ua.prototype.bulkGet=m("bulkGet",function(a,b){q(this,a,b)}),ua.prototype.compactDocument=m("compactDocument",function(a,b,c){var d=this;this._getRevisionTree(a,function(e,f){if(e)return c(e);var g=qa(f),h=[],i=[];Object.keys(g).forEach(function(a){g[a]>b&&h.push(a)}),P(f,function(a,b,c,d,e){var f=b+"-"+c;"available"===e.status&&-1!==h.indexOf(f)&&i.push(f)}),d._doCompaction(a,i,c)})}),ua.prototype.compact=m("compact",function(a,b){"function"==typeof a&&(b=a,a={});var c=this;a=a||{},c._compactionQueue=c._compactionQueue||[],c._compactionQueue.push({opts:a,callback:b}),1===c._compactionQueue.length&&sa(c)}),ua.prototype._compact=function(a,b){function c(a){g.push(e.compactDocument(a.id,0))}function d(a){var c=a.last_seq;yd.all(g).then(function(){return K(e,"_local/compaction",function(a){return!a.last_seq||a.last_seq<c?(a.last_seq=c,a):!1})}).then(function(){b(null,{ok:!0})})["catch"](b)}var e=this,f={return_docs:!1,last_seq:a.last_seq||0},g=[];e.changes(f).on("change",c).on("complete",d).on("error",b)},ua.prototype.get=m("get",function(a,b,c){function d(){var d=[],g=e.length;return g?void e.forEach(function(e){f.get(a,{rev:e,revs:b.revs,attachments:b.attachments},function(a,b){a?d.push({missing:e}):d.push({ok:b}),g--,g||c(null,d)})}):c(null,d)}if("function"==typeof b&&(c=b,b={}),"string"!=typeof a)return c(A(Id));if(fa(a)&&"function"==typeof this._getLocal)return this._getLocal(a,c);var e=[],f=this;if(!b.open_revs)return this._get(a,b,function(a,d){if(a)return c(a);var e=d.doc,g=d.metadata,h=d.ctx;if(b.conflicts){var i=S(g);i.length&&(e._conflicts=i)}if(ea(g,e._rev)&&(e._deleted=!0),b.revs||b.revs_info){var j=U(g.rev_tree),k=ma(j,function(a){return-1!==a.ids.map(function(a){return a.id}).indexOf(e._rev.split("-")[1])}),l=k.ids.map(function(a){return a.id}).indexOf(e._rev.split("-")[1])+1,m=k.ids.length-l;if(k.ids.splice(l,m),k.ids.reverse(),b.revs&&(e._revisions={start:k.pos+k.ids.length-1,ids:k.ids.map(function(a){return a.id})}),b.revs_info){var n=k.pos+k.ids.length;e._revs_info=k.ids.map(function(a){return n--,{rev:n+"-"+a.id,status:a.opts.status}})}}if(b.attachments&&e._attachments){var o=e._attachments,p=Object.keys(o).length;if(0===p)return c(null,e);Object.keys(o).forEach(function(a){this._getAttachment(e._id,a,o[a],{rev:e._rev,binary:b.binary,ctx:h},function(b,d){var f=e._attachments[a];f.data=d,delete f.stub,delete f.length,--p||c(null,e)})},f)}else{if(e._attachments)for(var q in e._attachments)e._attachments.hasOwnProperty(q)&&(e._attachments[q].stub=!0);c(null,e)}});if("all"===b.open_revs)this._getRevisionTree(a,function(a,b){return a?c(a):(e=R(b).map(function(a){return a.rev}),void d())});else{if(!Array.isArray(b.open_revs))return c(A(Md,"function_clause"));e=b.open_revs;for(var g=0;g<e.length;g++){var h=e[g];if("string"!=typeof h||!/^\d+-/.test(h))return c(A(Yd))}d()}}),ua.prototype.getAttachment=m("getAttachment",function(a,b,c,d){var e=this;c instanceof Function&&(d=c,c={}),this._get(a,c,function(f,g){return f?d(f):g.doc._attachments&&g.doc._attachments[b]?(c.ctx=g.ctx,c.binary=!0,e._getAttachment(a,b,g.doc._attachments[b],c,d),void 0):d(A(Gd))})}),ua.prototype.allDocs=m("allDocs",function(a,b){if("function"==typeof a&&(b=a,a={}),a.skip="undefined"!=typeof a.skip?a.skip:0,a.start_key&&(a.startkey=a.start_key),a.end_key&&(a.endkey=a.end_key),"keys"in a){if(!Array.isArray(a.keys))return b(new TypeError("options.keys must be an array"));var c=["startkey","endkey","key"].filter(function(b){return b in a})[0];if(c)return void b(A(Pd,"Query parameter `"+c+"` is not compatible with multi-get"));if("http"!==this.type())return ra(this,a,b)}return this._allDocs(a,b)}),ua.prototype.changes=function(a,b){return"function"==typeof a&&(b=a,a={}),new ja(this,a,b)},ua.prototype.close=m("close",function(a){return this._closed=!0,this._close(a)}),ua.prototype.info=m("info",function(a){var b=this;this._info(function(c,d){return c?a(c):(d.db_name=d.db_name||b._db_name,d.auto_compaction=!(!b.auto_compaction||"http"===b.type()),d.adapter=b.type(),void a(null,d))})}),ua.prototype.id=m("id",function(a){return this._id(a)}),ua.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},ua.prototype.bulkDocs=m("bulkDocs",function(a,b,c){if("function"==typeof b&&(c=b,b={}),b=b||{},Array.isArray(a)&&(a={docs:a}),!a||!a.docs||!Array.isArray(a.docs))return c(A(Fd));for(var d=0;d<a.docs.length;++d)if("object"!=typeof a.docs[d]||Array.isArray(a.docs[d]))return c(A(Sd));var e;return a.docs.forEach(function(a){a._attachments&&Object.keys(a._attachments).forEach(function(a){e=e||ta(a)})}),e?c(A(Rd,e)):("new_edits"in b||("new_edits"in a?b.new_edits=a.new_edits:b.new_edits=!0),b.new_edits||"http"===this.type()||a.docs.sort(pa),oa(a.docs),this._bulkDocs(a,b,function(a,d){return a?c(a):(b.new_edits||(d=d.filter(function(a){return a.error})),void c(null,d))}))}),ua.prototype.registerDependentDatabase=m("registerDependentDatabase",function(a,b){function c(b){return b.dependentDbs=b.dependentDbs||{},b.dependentDbs[a]?!1:(b.dependentDbs[a]=!0,b)}var d=new this.constructor(a,this.__opts);K(this,"_local/_pouch_dependentDbs",c).then(function(){b(null,{db:d})})["catch"](b)}),ua.prototype.destroy=m("destroy",function(a,b){function c(){d._destroy(a,function(a,c){return a?b(a):(d._destroyed=!0,d.emit("destroyed"),void b(null,c||{ok:!0}))})}"function"==typeof a&&(b=a,a={});var d=this,e="use_prefix"in d?d.use_prefix:!0;return"http"===d.type()?c():void d.get("_local/_pouch_dependentDbs",function(a,f){if(a)return 404!==a.status?b(a):c();var g=f.dependentDbs,h=d.constructor,i=Object.keys(g).map(function(a){var b=e?a.replace(new RegExp("^"+h.prefix),""):a;return new h(b,d.__opts).destroy()});yd.all(i).then(c,b)})}),va.prototype.execute=function(){var a;if(this.failed)for(;a=this.queue.shift();)a(this.failed);else for(;a=this.queue.shift();)a()},va.prototype.fail=function(a){this.failed=a,this.execute()},va.prototype.ready=function(a){this.isReady=!0,this.db=a,this.execute()},va.prototype.addTask=function(a){this.queue.push(a),this.failed&&this.execute()},pd(ya,ua),ya.debug=od,ya.adapters={},ya.preferredAdapters=[],ya.prefix="_pouch_";var he=new td.EventEmitter;za(ya),ya.parseAdapter=function(a,b){var c,d,e=a.match(/([a-z\-]*):\/\/(.*)/);if(e){if(a=/http(s?)/.test(e[1])?e[1]+"://"+e[2]:e[2],c=e[1],!ya.adapters[c].valid())throw"Invalid adapter";return{name:a,adapter:e[1]}}var f="idb"in ya.adapters&&"websql"in ya.adapters&&s()&&localStorage["_pouch__websqldb_"+ya.prefix+a];if(b.adapter)d=b.adapter;else if("undefined"!=typeof b&&b.db)d="leveldb";else for(var g=0;g<ya.preferredAdapters.length;++g)if(d=ya.preferredAdapters[g],d in ya.adapters){if(f&&"idb"===d){v("log",'PouchDB is downgrading "'+a+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}c=ya.adapters[d];var h=c&&"use_prefix"in c?c.use_prefix:!0;return{name:h?ya.prefix+a:a,adapter:d}},ya.adapter=function(a,b,c){b.valid()&&(ya.adapters[a]=b,c&&ya.preferredAdapters.push(a))},ya.plugin=function(a){return"function"==typeof a?a(ya):Object.keys(a).forEach(function(b){ya.prototype[b]=a[b]}),ya},ya.defaults=function(a){function b(c,d,e){return this instanceof b?("function"!=typeof d&&"undefined"!=typeof d||(e=d,d={}),c&&"object"==typeof c&&(d=c,c=void 0),d=nd.extend({},a,d),void ya.call(this,c,d,e)):new b(c,d,e)}return pd(b,ya),b.preferredAdapters=ya.preferredAdapters.slice(),Object.keys(ya).forEach(function(a){a in b||(b[a]=ya[a])}),b};var ie="5.4.1";ya.version=ie;var je,ke=Aa(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),le=Aa(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),me=function(a){return atob(a)},ne=function(a){return btoa(a)},oe=d.setImmediate||d.setTimeout,pe=32768,qe=5,re="document-store",se="by-sequence",te="attach-store",ue="attach-seq-store",ve="meta-store",we="local-store",xe="detect-blob-support",ye={running:!1,queue:[]},ze=new rd.Map,Ae=new u,Be=new rd.Map;nb.valid=function(){var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return!a&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var Ce=7,De=wb("document-store"),Ee=wb("by-sequence"),Fe=wb("attach-store"),Ge=wb("local-store"),He=wb("metadata-store"),Ie=wb("attach-seq-store"),Je=new rd.Map,Ke=new u,Le=1,Me="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+Ee+" (seq, deleted)",Ne="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+Ee+" (doc_id, rev)",Oe="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+De+" (winningseq)",Pe="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+Ie+" (seq)",Qe="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+Ie+" (digest, seq)",Re=Ee+".seq = "+De+".winningseq",Se=Ee+".seq AS seq, "+Ee+".deleted AS deleted, "+Ee+".json AS data, "+Ee+".rev AS rev, "+De+".json AS metadata";Qb.valid=Ob,Qb.use_prefix=!0;var Te=Vb(),Ue=function(){},Ve=25,We=50,Xe={},Ye=1800,Ze=od("pouchdb:http");fc.valid=function(){return!0},hc.prototype.add=function(a){return this.promise=this.promise["catch"](function(){}).then(function(){return a()}),this.promise},hc.prototype.finish=function(){return this.promise};var $e=function(a,b){return b&&a.then(function(a){c.nextTick(function(){b(null,a)})},function(a){c.nextTick(function(){b(a)})}),a},_e=function(a){return sd(function(b){var c=b.pop(),d=a.apply(this,b);return"function"==typeof c&&$e(d,c),d})},af=function(a,b){return a.then(function(a){return b().then(function(){return a})},function(a){return b().then(function(){throw a})})},bf=function(a,b){return function(){var c=arguments,d=this;return a.add(function(){return b.apply(d,c)})}},cf=function(a){for(var b={},c=0,d=a.length;d>c;c++)b["$"+a[c]]=!0;var e=Object.keys(b),f=new Array(e.length);for(c=0,d=e.length;d>c;c++)f[c]=e[c].substring(1);return f},df={},ef=new hc,ff=50,gf=v.bind(null,"log"),hf={_sum:function(a,b){return uc(b)},_count:function(a,b){return b.length},_stats:function(a,b){function c(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];b+=e*e}return b}return{sum:uc(b),min:Math.min.apply(null,b),max:Math.max.apply(null,b),count:b.length,sumsqr:c(b)}}},jf=_e(function(){var a=this;return"http"===a.type()?Mc(a):"function"==typeof a._viewCleanup?Cc(a):Nc(a)}),kf=function(a,b,c){"function"==typeof b&&(c=b,b={}),b=b?xc(b):{},"function"==typeof a&&(a={map:a});var d=this,e=yd.resolve().then(function(){return Oc(d,a,b)});return $e(e,c),e};pd(Pc,Error),pd(Qc,Error),pd(Rc,Error);var lf={query:kf,viewCleanup:jf},mf=1,nf="pouchdb",of=5,pf=0;Zc.prototype.writeCheckpoint=function(a,b){var c=this;return this.updateTarget(a,b).then(function(){return c.updateSource(a,b)})},Zc.prototype.updateTarget=function(a,b){return Yc(this.target,this.id,a,b,this.returnValue)},Zc.prototype.updateSource=function(a,b){var c=this;return this.readOnlySource?yd.resolve(!0):Yc(this.src,this.id,a,b,this.returnValue)["catch"](function(a){if(bd(a))return c.readOnlySource=!0,!0;throw a})};var qf={undefined:function(a,b){return 0===xd.collate(a.last_seq,b.last_seq)?b.last_seq:0},1:function(a,b){return $c(b,a).last_seq}};Zc.prototype.getCheckpoint=function(){var a=this;return a.target.get(a.id).then(function(b){return a.readOnlySource?yd.resolve(b.last_seq):a.src.get(a.id).then(function(a){if(b.version!==a.version)return pf;var c;return c=b.version?b.version.toString():"undefined",c in qf?qf[c](b,a):pf},function(c){if(404===c.status&&b.last_seq)return a.src.put({_id:a.id,last_seq:pf}).then(function(){return pf},function(c){return bd(c)?(a.readOnlySource=!0,b.last_seq):pf});throw c})})["catch"](function(a){if(404!==a.status)throw a;return pf})};var rf=0;pd(gd,td.EventEmitter),gd.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},gd.prototype.ready=function(a,b){function c(){e.cancel()}function d(){a.removeListener("destroyed",c),b.removeListener("destroyed",c)}var e=this;e._readyCalled||(e._readyCalled=!0,a.once("destroyed",c),b.once("destroyed",c),e.once("complete",d))},pd(kd,td.EventEmitter),kd.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},ya.plugin(qb).plugin(Rb).plugin(gc).plugin(lf).plugin(ld),b.exports=ya}).call(this,a(2),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1,10:10,12:12,14:14,15:15,16:16,17:17,2:2,4:4,5:5,8:8,9:9}],4:[function(a,b,c){"use strict";function d(a){return function(){var b=arguments.length;if(b){for(var c=[],d=-1;++d<b;)c[d]=arguments[d];return a.call(this,c)}return a.call(this,[])}}b.exports=d},{}],5:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?c.storage.removeItem("debug"):c.storage.debug=a}catch(b){}}function h(){var a;try{a=c.storage.debug}catch(b){}return a}function i(){try{return window.localStorage}catch(a){}}c=b.exports=a(6),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d,c.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:i(),c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{6:6}],6:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,
j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;d>e;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a(11),c.names=[],c.skips=[],c.formatters={};var j,k=0},{11:11}],7:[function(a,b,c){(function(a){"use strict";function c(){k=!0;for(var a,b,c=l.length;c;){for(b=l,l=[],a=-1;++a<c;)b[a]();c=l.length}k=!1}function d(a){1!==l.push(a)||k||e()}var e,f=a.MutationObserver||a.WebKitMutationObserver;if(f){var g=0,h=new f(c),i=a.document.createTextNode("");h.observe(i,{characterData:!0}),e=function(){i.data=g=++g%2}}else if(a.setImmediate||"undefined"==typeof a.MessageChannel)e="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var b=a.document.createElement("script");b.onreadystatechange=function(){c(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:function(){setTimeout(c,0)};else{var j=new a.MessageChannel;j.port1.onmessage=c,e=function(){j.port2.postMessage(0)}}var k,l=[];b.exports=d}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],9:[function(a,b,c){(function(){var a=Array.prototype.slice,b=Array.prototype.forEach,c=function(d){if("object"!=typeof d)throw d+" is not an object";var e=a.call(arguments,1);return b.call(e,function(a){if(a)for(var b in a)"object"==typeof a[b]&&d[b]?c.call(d,d[b],a[b]):d[b]=a[b]}),d};this.extend=c}).call(this)},{}],10:[function(a,b,c){"use strict";function d(){}function e(a){if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,a!==d&&i(this,a)}function f(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}function g(a,b,c){o(function(){var d;try{d=b(c)}catch(e){return p.reject(a,e)}d===a?p.reject(a,new TypeError("Cannot resolve promise with itself")):p.resolve(a,d)})}function h(a){var b=a&&a.then;return a&&"object"==typeof a&&"function"==typeof b?function(){b.apply(a,arguments)}:void 0}function i(a,b){function c(b){f||(f=!0,p.reject(a,b))}function d(b){f||(f=!0,p.resolve(a,b))}function e(){b(d,c)}var f=!1,g=j(e);"error"===g.status&&c(g.value)}function j(a,b){var c={};try{c.value=a(b),c.status="success"}catch(d){c.status="error",c.value=d}return c}function k(a){return a instanceof this?a:p.resolve(new this(d),a)}function l(a){var b=new this(d);return p.reject(b,a)}function m(a){function b(a,b){function d(a){g[b]=a,++h!==e||f||(f=!0,p.resolve(j,g))}c.resolve(a).then(d,function(a){f||(f=!0,p.reject(j,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=new Array(e),h=0,i=-1,j=new this(d);++i<e;)b(a[i],i);return j}function n(a){function b(a){c.resolve(a).then(function(a){f||(f=!0,p.resolve(h,a))},function(a){f||(f=!0,p.reject(h,a))})}var c=this;if("[object Array]"!==Object.prototype.toString.call(a))return this.reject(new TypeError("must be an array"));var e=a.length,f=!1;if(!e)return this.resolve([]);for(var g=-1,h=new this(d);++g<e;)b(a[g]);return h}var o=a(7),p={},q=["REJECTED"],r=["FULFILLED"],s=["PENDING"];b.exports=e,e.prototype["catch"]=function(a){return this.then(null,a)},e.prototype.then=function(a,b){if("function"!=typeof a&&this.state===r||"function"!=typeof b&&this.state===q)return this;var c=new this.constructor(d);if(this.state!==s){var e=this.state===r?a:b;g(c,e,this.outcome)}else this.queue.push(new f(c,a,b));return c},f.prototype.callFulfilled=function(a){p.resolve(this.promise,a)},f.prototype.otherCallFulfilled=function(a){g(this.promise,this.onFulfilled,a)},f.prototype.callRejected=function(a){p.reject(this.promise,a)},f.prototype.otherCallRejected=function(a){g(this.promise,this.onRejected,a)},p.resolve=function(a,b){var c=j(h,b);if("error"===c.status)return p.reject(a,c.value);var d=c.value;if(d)i(a,d);else{a.state=r,a.outcome=b;for(var e=-1,f=a.queue.length;++e<f;)a.queue[e].callFulfilled(b)}return a},p.reject=function(a,b){a.state=q,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a},e.resolve=k,e.reject=l,e.all=m,e.race=n},{7:7}],11:[function(a,b,c){function d(a){if(a=""+a,!(a.length>1e4)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return c*l;case"days":case"day":case"d":return c*k;case"hours":case"hour":case"hrs":case"hr":case"h":return c*j;case"minutes":case"minute":case"mins":case"min":case"m":return c*i;case"seconds":case"second":case"secs":case"sec":case"s":return c*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c}}}}function e(a){return a>=k?Math.round(a/k)+"d":a>=j?Math.round(a/j)+"h":a>=i?Math.round(a/i)+"m":a>=h?Math.round(a/h)+"s":a+"ms"}function f(a){return g(a,k,"day")||g(a,j,"hour")||g(a,i,"minute")||g(a,h,"second")||a+" ms"}function g(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var h=1e3,i=60*h,j=60*i,k=24*j,l=365.25*k;b.exports=function(a,b){return b=b||{},"string"==typeof a?d(a):b["long"]?f(a):e(a)}},{}],12:[function(a,b,c){"use strict";function d(a){if(null!==a)switch(typeof a){case"boolean":return a?1:0;case"number":return k(a);case"string":return a.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var b=Array.isArray(a),d=b?a:Object.keys(a),e=-1,f=d.length,g="";if(b)for(;++e<f;)g+=c.toIndexableString(d[e]);else for(;++e<f;){var h=d[e];g+=c.toIndexableString(h)+c.toIndexableString(a[h])}return g}return""}function e(a,b){var c,d=b,e="1"===a[b];if(e)c=0,b++;else{var f="0"===a[b];b++;var g="",h=a.substring(b,b+m),i=parseInt(h,10)+l;for(f&&(i=-i),b+=m;;){var j=a[b];if("\x00"===j)break;g+=j,b++}g=g.split("."),c=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),f&&(c-=10),0!==i&&(c=parseFloat(c+"e"+i))}return{num:c,length:b-d}}function f(a,b){var c=a.pop();if(b.length){var d=b[b.length-1];c===d.element&&(b.pop(),d=b[b.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(c);else if(f===a.length-2){var g=a.pop();e[g]=c}else a.push(c)}}function g(a,b){for(var d=Math.min(a.length,b.length),e=0;d>e;e++){var f=c.collate(a[e],b[e]);if(0!==f)return f}return a.length===b.length?0:a.length>b.length?1:-1}function h(a,b){return a===b?0:a>b?1:-1}function i(a,b){for(var d=Object.keys(a),e=Object.keys(b),f=Math.min(d.length,e.length),g=0;f>g;g++){var h=c.collate(d[g],e[g]);if(0!==h)return h;if(h=c.collate(a[d[g]],b[e[g]]),0!==h)return h}return d.length===e.length?0:d.length>e.length?1:-1}function j(a){var b=["boolean","number","string","object"],c=b.indexOf(typeof a);return~c?null===a?1:Array.isArray(a)?5:3>c?c+2:c+3:Array.isArray(a)?5:void 0}function k(a){if(0===a)return"1";var b=a.toExponential().split(/e\+?/),c=parseInt(b[1],10),d=0>a,e=d?"0":"2",f=(d?-c:c)-l,g=o.padLeft(f.toString(),"0",m);e+=n+g;var h=Math.abs(parseFloat(b[0]));d&&(h=10-h);var i=h.toFixed(20);return i=i.replace(/\.?0+$/,""),e+=n+i}var l=-324,m=3,n="",o=a(13);c.collate=function(a,b){if(a===b)return 0;a=c.normalizeKey(a),b=c.normalizeKey(b);var d=j(a),e=j(b);if(d-e!==0)return d-e;if(null===a)return 0;switch(typeof a){case"number":return a-b;case"boolean":return a===b?0:b>a?-1:1;case"string":return h(a,b)}return Array.isArray(a)?g(a,b):i(a,b)},c.normalizeKey=function(a){switch(typeof a){case"undefined":return null;case"number":return a===1/0||a===-(1/0)||isNaN(a)?null:a;case"object":var b=a;if(Array.isArray(a)){var d=a.length;a=new Array(d);for(var e=0;d>e;e++)a[e]=c.normalizeKey(b[e])}else{if(a instanceof Date)return a.toJSON();if(null!==a){a={};for(var f in b)if(b.hasOwnProperty(f)){var g=b[f];"undefined"!=typeof g&&(a[f]=c.normalizeKey(g))}}}}return a},c.toIndexableString=function(a){var b="\x00";return a=c.normalizeKey(a),j(a)+n+d(a)+b},c.parseIndexableString=function(a){for(var b=[],c=[],d=0;;){var g=a[d++];if("\x00"!==g)switch(g){case"1":b.push(null);break;case"2":b.push("1"===a[d]),d++;break;case"3":var h=e(a,d);b.push(h.num),d+=h.length;break;case"4":for(var i="";;){var j=a[d];if("\x00"===j)break;i+=j,d++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),b.push(i);break;case"5":var k={element:[],index:b.length};b.push(k.element),c.push(k);break;case"6":var l={element:{},index:b.length};b.push(l.element),c.push(l);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}else{if(1===b.length)return b.pop();f(b,c)}}}},{13:13}],13:[function(a,b,c){"use strict";function d(a,b,c){for(var d="",e=c-a.length;d.length<e;)d+=b;return d}c.padLeft=function(a,b,c){var e=d(a,b,c);return e+a},c.padRight=function(a,b,c){var e=d(a,b,c);return a+e},c.stringLexCompare=function(a,b){var c,d=a.length,e=b.length;for(c=0;d>c;c++){if(c===e)return 1;var f=a.charAt(c),g=b.charAt(c);if(f!==g)return g>f?-1:1}return e>d?-1:0},c.intToDecimalForm=function(a){var b=0>a,c="";do{var d=b?-Math.ceil(a%10):Math.floor(a%10);c=d+c,a=b?Math.ceil(a/10):Math.floor(a/10)}while(a);return b&&"0"!==c&&(c="-"+c),c}},{}],14:[function(a,b,c){"use strict";function d(){this.store={}}function e(a){if(this.store=new d,a&&Array.isArray(a))for(var b=0,c=a.length;c>b;b++)this.add(a[b])}c.Map=d,c.Set=e,d.prototype.mangle=function(a){if("string"!=typeof a)throw new TypeError("key must be a string but Got "+a);return"$"+a},d.prototype.unmangle=function(a){return a.substring(1)},d.prototype.get=function(a){var b=this.mangle(a);return b in this.store?this.store[b]:void 0},d.prototype.set=function(a,b){var c=this.mangle(a);return this.store[c]=b,!0},d.prototype.has=function(a){var b=this.mangle(a);return b in this.store},d.prototype["delete"]=function(a){var b=this.mangle(a);return b in this.store?(delete this.store[b],!0):!1},d.prototype.forEach=function(a){for(var b=Object.keys(this.store),c=0,d=b.length;d>c;c++){var e=b[c],f=this.store[e];e=this.unmangle(e),a(f,e)}},e.prototype.add=function(a){return this.store.set(a,!0)},e.prototype.has=function(a){return this.store.has(a)},e.prototype["delete"]=function(a){return this.store["delete"](a)}},{}],15:[function(a,b,c){(function(){var a={}.hasOwnProperty,c=[].slice;b.exports=function(b,d){var e,f,g,h;f=[],h=[];for(e in d)a.call(d,e)&&(g=d[e],"this"!==e&&(f.push(e),h.push(g)));return Function.apply(null,c.call(f).concat([b])).apply(d["this"],h)}}).call(this)},{}],16:[function(b,c,d){!function(b){if("object"==typeof d)c.exports=b();else if("function"==typeof a&&a.amd)a(b);else{var e;try{e=window}catch(f){e=self}e.SparkMD5=b()}}(function(a){"use strict";function b(a,b,c,d,e,f){return b=t(t(b,a),t(d,f)),t(b<<e|b>>>32-e,c)}function c(a,c,d,e,f,g,h){return b(c&d|~c&e,a,c,f,g,h)}function d(a,c,d,e,f,g,h){return b(c&e|d&~e,a,c,f,g,h)}function e(a,c,d,e,f,g,h){return b(c^d^e,a,c,f,g,h)}function f(a,c,d,e,f,g,h){return b(d^(c|~e),a,c,f,g,h)}function g(a,b){var g=a[0],h=a[1],i=a[2],j=a[3];g=c(g,h,i,j,b[0],7,-680876936),j=c(j,g,h,i,b[1],12,-389564586),i=c(i,j,g,h,b[2],17,606105819),h=c(h,i,j,g,b[3],22,-1044525330),g=c(g,h,i,j,b[4],7,-176418897),j=c(j,g,h,i,b[5],12,1200080426),i=c(i,j,g,h,b[6],17,-1473231341),h=c(h,i,j,g,b[7],22,-45705983),g=c(g,h,i,j,b[8],7,1770035416),j=c(j,g,h,i,b[9],12,-1958414417),i=c(i,j,g,h,b[10],17,-42063),h=c(h,i,j,g,b[11],22,-1990404162),g=c(g,h,i,j,b[12],7,1804603682),j=c(j,g,h,i,b[13],12,-40341101),i=c(i,j,g,h,b[14],17,-1502002290),h=c(h,i,j,g,b[15],22,1236535329),g=d(g,h,i,j,b[1],5,-165796510),j=d(j,g,h,i,b[6],9,-1069501632),i=d(i,j,g,h,b[11],14,643717713),h=d(h,i,j,g,b[0],20,-373897302),g=d(g,h,i,j,b[5],5,-701558691),j=d(j,g,h,i,b[10],9,38016083),i=d(i,j,g,h,b[15],14,-660478335),h=d(h,i,j,g,b[4],20,-405537848),g=d(g,h,i,j,b[9],5,568446438),j=d(j,g,h,i,b[14],9,-1019803690),i=d(i,j,g,h,b[3],14,-187363961),h=d(h,i,j,g,b[8],20,1163531501),g=d(g,h,i,j,b[13],5,-1444681467),j=d(j,g,h,i,b[2],9,-51403784),i=d(i,j,g,h,b[7],14,1735328473),h=d(h,i,j,g,b[12],20,-1926607734),g=e(g,h,i,j,b[5],4,-378558),j=e(j,g,h,i,b[8],11,-2022574463),i=e(i,j,g,h,b[11],16,1839030562),h=e(h,i,j,g,b[14],23,-35309556),g=e(g,h,i,j,b[1],4,-1530992060),j=e(j,g,h,i,b[4],11,1272893353),i=e(i,j,g,h,b[7],16,-155497632),h=e(h,i,j,g,b[10],23,-1094730640),g=e(g,h,i,j,b[13],4,681279174),j=e(j,g,h,i,b[0],11,-358537222),i=e(i,j,g,h,b[3],16,-722521979),h=e(h,i,j,g,b[6],23,76029189),g=e(g,h,i,j,b[9],4,-640364487),j=e(j,g,h,i,b[12],11,-421815835),i=e(i,j,g,h,b[15],16,530742520),h=e(h,i,j,g,b[2],23,-995338651),g=f(g,h,i,j,b[0],6,-198630844),j=f(j,g,h,i,b[7],10,1126891415),i=f(i,j,g,h,b[14],15,-1416354905),h=f(h,i,j,g,b[5],21,-57434055),g=f(g,h,i,j,b[12],6,1700485571),j=f(j,g,h,i,b[3],10,-1894986606),i=f(i,j,g,h,b[10],15,-1051523),h=f(h,i,j,g,b[1],21,-2054922799),g=f(g,h,i,j,b[8],6,1873313359),j=f(j,g,h,i,b[15],10,-30611744),i=f(i,j,g,h,b[6],15,-1560198380),h=f(h,i,j,g,b[13],21,1309151649),g=f(g,h,i,j,b[4],6,-145523070),j=f(j,g,h,i,b[11],10,-1120210379),i=f(i,j,g,h,b[2],15,718787259),h=f(h,i,j,g,b[9],21,-343485551),a[0]=t(g,a[0]),a[1]=t(h,a[1]),a[2]=t(i,a[2]),a[3]=t(j,a[3])}function h(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c}function i(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24);return c}function j(a){var b,c,d,e,f,i,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,h(a.substring(b-64,b)));for(a=a.substring(b-64),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a.charCodeAt(b)<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),i=parseInt(e[1],16)||0,d[14]=f,d[15]=i,g(k,d),k}function k(a){var b,c,d,e,f,h,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,i(a.subarray(b-64,b)));for(a=j>b-64?a.subarray(b-64):new Uint8Array(0),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a[b]<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),h=parseInt(e[1],16)||0,d[14]=f,d[15]=h,g(k,d),k}function l(a){var b,c="";for(b=0;4>b;b+=1)c+=u[a>>8*b+4&15]+u[a>>8*b&15];return c}function m(a){var b;for(b=0;b<a.length;b+=1)a[b]=l(a[b]);return a.join("")}function n(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),a}function o(a,b){var c,d=a.length,e=new ArrayBuffer(d),f=new Uint8Array(e);for(c=0;d>c;c+=1)f[c]=a.charCodeAt(c);return b?f:e}function p(a){return String.fromCharCode.apply(null,new Uint8Array(a))}function q(a,b,c){var d=new Uint8Array(a.byteLength+b.byteLength);return d.set(new Uint8Array(a)),d.set(new Uint8Array(b),a.byteLength),c?d:d.buffer}function r(a){var b,c=[],d=a.length;for(b=0;d-1>b;b+=2)c.push(parseInt(a.substr(b,2),16));return String.fromCharCode.apply(String,c)}function s(){this.reset()}var t=function(a,b){return a+b&4294967295},u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==m(j("hello"))&&(t=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||!function(){function b(a,b){return a=0|a||0,0>a?Math.max(a+b,0):Math.min(a,b)}ArrayBuffer.prototype.slice=function(c,d){var e,f,g,h,i=this.byteLength,j=b(c,i),k=i;return d!==a&&(k=b(d,i)),j>k?new ArrayBuffer(0):(e=k-j,f=new ArrayBuffer(e),g=new Uint8Array(f),h=new Uint8Array(this,j,e),g.set(h),f)}}(),s.prototype.append=function(a){return this.appendBinary(n(a)),this},s.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var b,c=this._buff.length;for(b=64;c>=b;b+=64)g(this._hash,h(this._buff.substring(b-64,b)));return this._buff=this._buff.substring(b-64),this},s.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d.charCodeAt(b)<<(b%4<<3);return this._finish(f,e),c=m(this._hash),a&&(c=r(c)),this.reset(),c},s.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},s.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},s.prototype.setState=function(a){return this._buff=a.buff,this._length=a.length,this._hash=a.hash,this},s.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},s.prototype._finish=function(a,b){var c,d,e,f=b;if(a[f>>2]|=128<<(f%4<<3),f>55)for(g(this._hash,a),f=0;16>f;f+=1)a[f]=0;c=8*this._length,c=c.toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(c[2],16),e=parseInt(c[1],16)||0,a[14]=d,a[15]=e,g(this._hash,a)},s.hash=function(a,b){return s.hashBinary(n(a),b)},s.hashBinary=function(a,b){var c=j(a),d=m(c);return b?r(d):d},s.ArrayBuffer=function(){this.reset()},s.ArrayBuffer.prototype.append=function(a){var b,c=q(this._buff.buffer,a,!0),d=c.length;for(this._length+=a.byteLength,b=64;d>=b;b+=64)g(this._hash,i(c.subarray(b-64,b)));return this._buff=d>b-64?new Uint8Array(c.buffer.slice(b-64)):new Uint8Array(0),this},s.ArrayBuffer.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d[b]<<(b%4<<3);return this._finish(f,e),c=m(this._hash),a&&(c=r(c)),this.reset(),c},s.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},s.ArrayBuffer.prototype.getState=function(){var a=s.prototype.getState.call(this);return a.buff=p(a.buff),a},s.ArrayBuffer.prototype.setState=function(a){return a.buff=o(a.buff,!0),s.prototype.setState.call(this,a)},s.ArrayBuffer.prototype.destroy=s.prototype.destroy,s.ArrayBuffer.prototype._finish=s.prototype._finish,s.ArrayBuffer.hash=function(a,b){var c=k(new Uint8Array(a)),d=m(c);return b?r(d):d},s})},{}],17:[function(a,b,c){"use strict";function d(a,b,c){var d=c[c.length-1];a===d.element&&(c.pop(),d=c[c.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(a);else if(f===b.length-2){var g=b.pop();e[g]=a}else b.push(a)}c.stringify=function(a){var b=[];b.push({obj:a});for(var c,d,e,f,g,h,i,j,k,l,m,n="";c=b.pop();)if(d=c.obj,e=c.prefix||"",f=c.val||"",n+=e,f)n+=f;else if("object"!=typeof d)n+="undefined"==typeof d?null:JSON.stringify(d);else if(null===d)n+="null";else if(Array.isArray(d)){for(b.push({val:"]"}),g=d.length-1;g>=0;g--)h=0===g?"":",",b.push({obj:d[g],prefix:h});b.push({val:"["})}else{i=[];for(j in d)d.hasOwnProperty(j)&&i.push(j);for(b.push({val:"}"}),g=i.length-1;g>=0;g--)k=i[g],l=d[k],m=g>0?",":"",m+=JSON.stringify(k)+":",b.push({obj:l,prefix:m});b.push({val:"{"})}return n},c.parse=function(a){for(var b,c,e,f,g,h,i,j,k,l=[],m=[],n=0;;)if(b=a[n++],"}"!==b&&"]"!==b&&"undefined"!=typeof b)switch(b){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,d(null,l,m);break;case"t":n+=3,d(!0,l,m);break;case"f":n+=4,d(!1,l,m);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(c="",n--;;){if(e=a[n++],!/[\d\.\-e\+]/.test(e)){n--;break}c+=e}d(parseFloat(c),l,m);break;case'"':for(f="",g=void 0,h=0;;){if(i=a[n++],'"'===i&&("\\"!==g||h%2!==1))break;f+=i,g=i,"\\"===g?h++:h=0}d(JSON.parse('"'+f+'"'),l,m);break;case"[":j={element:[],index:l.length},l.push(j.element),m.push(j);break;case"{":k={element:{},index:l.length},l.push(k.element),m.push(k);break;default:throw new Error("unexpectedly reached end of input: "+b)}else{if(1===l.length)return l.pop();d(l.pop(),l,m)}}},{}]},{},[3])(3)})}(),h()}),a.register("c",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("Model",e=function(){function a(){c(this,a)}return d(a,[{key:"set",value:function(a){var b=this.constructor;for(var c in a)a.hasOwnProperty(c)&&-1!==b.properties.indexOf(c)&&(this[c]=a[c])}},{key:"toJSON",value:function(){var a=this,b=this.constructor,c={};return(b.properties||[]).forEach(function(b){c[b]=a[b]}),c}}],[{key:"properties",get:function(){return[]}}]),a}()),a("Model",e),e.ready=Promise.resolve()}}}),a.register("e",["3","4","9","a","d","c"],function(a,b){"use strict";var c,d,e,f,g,h,i;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a["default"]},function(a){h=a.Model}],execute:function(){a("DBModel",i=function(a){function b(){c(this,b);var a=e(this,Object.getPrototypeOf(b).call(this)),d=a.constructor;return d.db||d.initDB(),a.__db=d.db,a}return f(b,a),d(b,[{key:"beforeFetch",value:function(){return Promise.resolve()}},{key:"afterFetch",value:function(a){return Promise.resolve(a)}},{key:"fetch",value:function(){var a=this;return this.beforeFetch.apply(this,arguments).then(function(){return a.__db.get(a.dbKey).then(function(b){return a.afterFetch(b).then(function(){return a.set(b),Promise.resolve(b)})})})}},{key:"sync",value:function(){return this.__db.put(this.toJSON(),this.dbKey)}},{key:"dbKey",get:function(){return this.id}},{key:"fetchOptions",get:function(){return{}}}],[{key:"initDB",value:function(){if(this.database)return this.db=new g(this.database),this.db;throw new Error("Missing database name.")}},{key:"database",get:function(){return""}}]),b}(h)),a("DBModel",i)}}}),a.register("f",["3","4","7","8","9","a","e"],function(a,b){"use strict";var c,d,e,f,g,h,i,j;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){f=a["default"]},function(a){h=a.AjaxModel},function(a){e=a["default"]},function(a){g=a["default"]},function(a){i=a.DBModel}],execute:function(){a("SyncModel",j=function(a){function b(){return c(this,b),e(this,Object.getPrototypeOf(b).apply(this,arguments))}return g(b,a),d(b,[{key:"fetch",value:function(){for(var a,c=this,d=arguments.length,e=Array(d),g=0;d>g;g++)e[g]=arguments[g];return(a=h.prototype.fetch).call.apply(a,[this].concat(e)).then(function(){return c.sync()},function(){var a;return(a=f(Object.getPrototypeOf(b.prototype),"fetch",c)).call.apply(a,[c].concat(e))})}}]),b}(i)),a("SyncModel",j)}}}),a.register("10",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)})}}}),a.register("11",["3","4","5"],function(a,b){"use strict";function c(a,b,c,d){return a=a||{},a.timestamp=Date.now(),{state:a,title:b,url:c,type:d}}var d,e,f,g;return{setters:[function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a.CallbackManager}],execute:function(){a("History",g=function(){function a(){d(this,a);var b=new f;b.attachToPrototype(this),this.reset()}return e(a,[{key:"reset",value:function(){this.index=0,this.entries=[]}},{key:"go",value:function(a){if(0!==a){var b=this.index+a;b=Math.max(b,0),b=Math.min(b,this.entries.length-1),this.index=b,this.trigger("popstate",this.current)}return this.current}},{key:"back",value:function(){return this.go(-1)}},{key:"forward",value:function(){return this.go(1)}},{key:"indexOfState",value:function(a){a=a||{};for(var b=this.entries.slice(0).reverse(),c=0,d=b.length;d>c;c++)if(b[c].state.timestamp===a.timestamp)return c;return-1}},{key:"pushState",value:function(a,b,d){var e=c(a,b,d,"push");return this.entries=this.entries.slice(0,this.index+1),this.entries.push(e),this.go(1),this.trigger("popstate",e),e}},{key:"replaceState",value:function(a,b,d){var e=c(a,b,d,"replace");return this.entries[this.index]=e,e}},{key:"current",get:function(){return this.entries[this.index]}},{key:"length",get:function(){return this.entries.length}}]),a}()),a("History",g)}}}),a.register("12",["3","4","11"],function(a,b){"use strict";function c(a,b){a.routes.some(function(c){var d=a.parser(a.normalize(b),a.normalize(c));if(null!==d){var e=o[a.id]&&o[a.id][c]||[];return e.forEach(function(b){b.apply(a,d)}),!0}return!1})}function d(a,b){var c=arguments.length<=2||void 0===arguments[2]?0:arguments[2],d=void 0;return function(){clearTimeout(d),d=setTimeout(b.bind(a),c)}}function e(a){var b=this.history;if(a instanceof Event){var c=l.state,d=b.indexOfState(c);if(-1!==d){var e=b.length-b.index-1-d;b.go(e)}else{var f=this.getPathFromBase(),g=b.pushState(null,document.title,f);l.replaceState(g,document.title,this.resolve(f))}}else if(!l.state||l.state.timestamp!==b.current.state.timestamp){var h=this.resolve(a.url);"push"===a.type?l.pushState(a.state,a.title,h):l.replaceState(a.state,a.title,h)}}function f(){var a=this.history.current,b=this.resolve(a.url);l.replaceState(a.state,a.title,b),this._onPopState=e.bind(this),this.history.on("popstate",this._onPopState),window.addEventListener("popstate",this._onPopState)}function g(){this._onPopState&&(this.history.off("popstate",this._onPopState),window.removeEventListener("popstate",this._onPopState),delete this._onPopState,delete this._onHashChange)}var h,i,j,k,l,m,n,o,p,q;return{setters:[function(a){h=a["default"]},function(a){i=a["default"]},function(a){j=a.History}],execute:function(){k="undefined"!=typeof window&&"function"==typeof window.addEventListener,l=k&&window.history,m=k&&(l&&l.location||window&&window.location),n=/^((https?|s?ftps?):\/+)?(.+?)(?=\/|$)/i,o={},p=0,a("Router",q=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];h(this,a),this.history=new j,this.started=!1,this.reset(),this.options={};for(var c in this.DEFAULTS)b.hasOwnProperty(c)?this.options[c]=b[c]:this.DEFAULTS.hasOwnProperty(c)&&(this.options[c]=this.DEFAULTS[c]);this.base=this.options.base,this.id=p,p++}return i(a,[{key:"DEFAULTS",get:function(){return{base:"#",dispatch:!0,bind:!0}}}]),i(a,[{key:"parser",value:function(a,b){b=b.replace(/\*/g,"([^/?#]+?)").replace(/\.\./,"(.*)");var c=new RegExp("^"+b+"$"),d=a.match(c);return d?d.slice(1):null}},{key:"reset",value:function(){delete o[this.id],this.routes=[]}},{key:"getPathFromBase",value:function(b){var c=this.base;return c&&"#"===c[0]?(b=b||m.href||"",b.split(c)[1]||""):(b=m?a.getPathFromRoot(b):b||"",b.replace(c,""))}},{key:"trigger",value:function(a){var b=this.history.current.url;return a||b!==this.current?(c(this,b),this.current=b,!0):!1}},{key:"on",value:function(a,b){a=this.normalize(a),a="/"+a,this.routes.push(a),o[this.id]=o[this.id]||{},o[this.id][a]=o[this.id][a]||[],o[this.id][a].push(b)}},{key:"navigate",value:function(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return this.started?(a=this.normalize(a),c?this.history.replaceState(null,b,a):this.history.pushState(null,b,a),this.trigger()):!1}},{key:"back",value:function(){return this.started?this.history.back():!1}},{key:"forward",value:function(){return this.started?this.history.forward():!1}},{key:"start",value:function(){this.started||(this.current=this.getPathFromBase(),this.history.pushState(null,document.title,this.current),k&&(this.debouncedEmit=d(this,this.trigger,1).bind(this),this.history.on("popstate",this.debouncedEmit),this.options.dispatch&&this.trigger(!0),this.options.dispatch=!0,this.options.bind&&f.call(this)),this.started=!0)}},{key:"stop",value:function(){this.started&&(this.history.reset(),this.history.off("popstate",this.debouncedEmit),this.reset(),g.call(this),this.started=!1)}},{key:"normalize",value:function(a){return a.replace(/^\/|\/$/,"")}},{key:"resolve",value:function(a){return(this.base+"/"+a).replace(/\/+/,"/")}},{key:"query",value:function(a){var b={};return a=a||this.current||this.getPathFromBase(),a.replace(/[?&](.+?)=([^&]*)/g,function(a,c,d){b[c]=d}),b}}],[{key:"getPathFromRoot",value:function(a){return a=a||m.href,a.replace(n,"")}}]),a}()),a("Router",q)}}}),a.register("5",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("CallbackManager",e=function(){function a(){c(this,a),this.callbacks={}}return d(a,[{key:"attachToPrototype",value:function(a){var b=this;a.on=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return b.on.apply(b,[this].concat(c))},a.off=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return b.off.apply(b,[this].concat(c))},a.trigger=function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return b.trigger.apply(b,[this].concat(c))}}},{key:"on",value:function(a,b,c){if("string"==typeof a&&"function"==typeof b&&(c=b,b=a,a=this),"function"==typeof c){var d=this.callbacks[a]=this.callbacks[a]||{},e=d[b]=d[b]||{length:0},f=e.length;return e[f]={fn:c,destroy:function(a,b){return function(){"undefined"!=typeof a[b]&&delete a[b]}}(d[b],f)},e.length+=1,this.callbacks[a][b][f].destroy}return null}},{key:"off",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?null:arguments[1];"string"==typeof a&&(b=a,a=this);var c=this.callbacks[a];if(c)if(b){var d=c[b];for(var e in d)"object"==typeof d[e]&&"function"==typeof d[e].destroy&&d[e].destroy.call(a)}else for(var f in c)c.hasOwnProperty(f)&&this.reset(f)}},{key:"trigger",value:function(a,b){"string"==typeof a&&(b=a,a=this);for(var c=this.callbacks[a]||{},d=c[b]||{},e=arguments.length,f=Array(e>2?e-2:0),g=2;e>g;g++)f[g-2]=arguments[g];for(var h in d)if(d.hasOwnProperty(h)){var i=d[h];"object"==typeof i&&"function"==typeof i.fn&&i.fn.apply(a,f)}}}]),a}()),a("CallbackManager",e)}}}),a.register("13",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("RegisterHelper",e=function(){function a(b){var d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];c(this,a),this.serviceWorkerUrl=b,this.serviceWorkerOptions=d}return d(a,[{key:"register",value:function(){var a=this;return"serviceWorker"in navigator?(this.opening=!0,this.registerPromise=new Promise(function(b,c){navigator.serviceWorker.register(a.serviceWorkerUrl,a.serviceWorkerOptions).then(function(c){var d=c.installing||c.waiting||c.active;delete a.opening,a.worker=d,b(d)})["catch"](function(){delete a.opening,c()})})):this.registerPromise=Promise.reject(),this.registerPromise}},{key:"onReady",value:function(){return this.registerPromise}}]),a}()),a("RegisterHelper",e)}}}),a.register("14",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("View",e=function(){function a(b){var d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];c(this,a);
var e=document.createElement("div");for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);e.controller=b,this.content=e}return d(a,[{key:"getContent",value:function(){return Promise.resolve(this.content)}},{key:"destroy",value:function(){return this.content&&this.content.parentNode&&this.content.parentNode.removeChild(this.content),Promise.resolve()}}]),a}()),a("View",e)}}}),a.register("15",["3"],function(a,b){"use strict";function c(a){var b=arguments.length<=1||void 0===arguments[1]?"Animation":arguments[1],c=window.getComputedStyle(a);if(c){var d=c[b.toLowerCase()+"Duration"]||c["webkit"+b+"Duration"]||c["moz"+b+"Duration"]||c["ms"+b+"Duration"]||c["o"+b+"Duration"];if(d)return parseFloat(d)}return 0}function d(a){return c(a,"Transition")}var e,f;return{setters:[function(a){e=a["default"]}],execute:function(){a("PageView",f=function b(a){e(this,b);var f=document.createElement("section");return f.className="page-view",Object.defineProperty(f,"destroy",{value:function(b){return a.destroy().then(function(){return f.hide(b).then(function(){f&&f.parentNode&&f.parentNode.removeChild(f)}),Promise.resolve()})}}),Object.defineProperty(f,"hide",{value:function(a){return new Promise(function(b){if(f.setAttribute("hidden",""),a)b();else{f.setAttribute("data-hidden-animation","");var e=c(f)||d(f)||0;setTimeout(function(){f.removeAttribute("data-hidden-animation"),b()},1e3*e)}})}}),Object.defineProperty(f,"show",{value:function(a){return new Promise(function(b){if(f.removeAttribute("hidden"),a)b();else{f.setAttribute("data-hidden-animation","");var e=c(f)||d(f)||0;setTimeout(function(){f.removeAttribute("data-hidden-animation"),b()},1e3*e)}})}}),f}),a("PageView",f)}}}),a.register("16",["3","4","15"],function(a,b){"use strict";var c,d,e,f;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a.PageView}],execute:function(){a("PagesHelper",f=function(){function a(b){c(this,a),this.wrapper=b||document.body}return d(a,[{key:"add",value:function(a){var b=this,c=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],d=new this.PageComponent(a);return a.getContent().then(function(a){return a instanceof Node?d.appendChild(a):"string"==typeof a&&(d.innerHTML=a),c?d.show(!0):d.hide(!0),b.wrapper.appendChild(d),Promise.resolve(d)})}},{key:"remove",value:function(a){return a?a.destroy():Promise.resolve()}},{key:"PageComponent",get:function(){return e}}]),a}()),a("PagesHelper",f)}}}),a.register("17",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("ViewHelper",e=function(){function a(b){c(this,a),this.App=b}return d(a,[{key:"if",value:function(a,b){return a?b():""}},{key:"forEach",value:function(a,b){return Array.prototype.map.call(a,b).join("")}},{key:"translate",value:function(a){if(this.App.i18n){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];return(b=this.App.i18n).translate.apply(b,[a].concat(d))}return a}},{key:"dump",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];if(a){var c=JSON.stringify(a,null,b?4:0).replace(/</g,"&lt;").replace(/>/g,"&gt;");return"<pre>"+c+"</pre>"}return"<undefined>"}},{key:"log",value:function(){var a;return(a=console).log.apply(a,arguments),""}}]),a}()),a("ViewHelper",e)}}}),a.register("b",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("Ajax",e=function(){function a(){c(this,a)}return d(a,null,[{key:"request",value:function(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return new Promise(function(c,d){var e=window.XMLHttpRequest||window.ActiveXObject,f=new e("MSXML2.XMLHTTP.3.0"),g=!1;"string"==typeof b&&(b={url:b});for(var h in a.defaultOptions)"undefined"==typeof b[h]&&(b[h]=a.defaultOptions[h]);if(f.open(b.method||"GET",b.url,!!b.async),b.headers){var i=b.headers;for(var j in i)i.hasOwnProperty(j)&&f.setRequestHeader(j,i[j])}b.responseType&&(f.responseType=b.responseType),f.onreadystatechange=function(){if(4===f.readyState){var a=function(a){var c=void 0;if("text"===b.responseType&&"string"==typeof a.responseText)c=a.responseText;else if("undefined"!=typeof a.response)c="json"===b.responseType&&"string"==typeof a.response?JSON.parse(a.response):a.response;else try{c="json"===b.responseType&&"string"==typeof a.responseText?JSON.parse(a.responseText):a.responseText}catch(d){c=a.responseText}return c};g=!0,f.status>=200&&f.status<300||304===f.status?c(a(f)):d(f)}},f.onerror=function(){g=!0,d(f)},f.onabort=function(){g=!0,d(f)},f.addEventListener("progress",function(a){var c=a.loaded||a.position,d=a.total||a.totalSize;"function"==typeof b.notify&&b.notify(c,d)},!1),f.upload&&(f.upload.onprogress=function(a){var c=a.loaded||a.position,d=a.total||a.totalSize;"function"==typeof b.notify&&b.notify(c,d)});var k=b.data;void 0!==k?f.send(b.data):f.send(),b.timeout&&setTimeout(function(){g||(f.timeout=!0,f.status=0,d(f))},b.timeout)})}},{key:"head",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return c.url=b,c.method="HEAD",a.request(c)}},{key:"get",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return c.url=b,c.method="GET",a.request(c)}},{key:"post",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],d=arguments[2];return c.url=b,c.method="POST",void 0!==d&&(c.data=d),a.request(c)}},{key:"put",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],d=arguments[2];return c.url=b,c.method="PUT",void 0!==d&&(c.data=d),a.request(c)}},{key:"delete",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return c.url=b,c.method="DELETE",a.request(c)}},{key:"defaultOptions",get:function(){return{async:!0,timeout:6e4,responseType:"json",headers:{"X-Requested-With":"XMLHttpRequest","Content-type":"application/x-www-form-urlencoded"}}}}]),a}()),a("Ajax",e)}}}),a.register("18",["3","4","b"],function(a,b){"use strict";function c(a,b){for(var c=b.split("."),d=a,e=0;e<c.length;++e){if("undefined"==typeof d[c[e]])return;d=d[c[e]]}return d}function d(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];return a.replace(/{(\d+)}/g,function(a,b){return"undefined"!=typeof c[b]?c[b]:a})}var e,f,g,h;return{setters:[function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a.Ajax}],execute:function(){a("I18N",h=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];e(this,a);var c=this.defaultOptions;for(var d in b)c.hasOwnProperty(d)&&(c[d]=b[d]);"auto"===c.autoLoad&&window&&window.location&&(c.autoLoad="file:"!==window.location.protocol),"auto"===c.defaultLang&&(c.defaultLang=a.detect()),this.vocabularies={},this.options=c,c.autoLoad&&this.fetch()}return f(a,[{key:"defaultOptions",get:function(){return{defaultLang:"auto",fallbackLang:"en",autoLoad:"auto",path:"locales",filename:"translation",languages:["en","es","de","fr","it"]}}}]),f(a,[{key:"fetch",value:function(){var a=this;return Promise.all(this.options.languages.map(function(b){return a.load(b)}))}},{key:"addResources",value:function(a,b){var c=this.options;b=b||c.defaultLang,this.vocabularies[b]=this.vocabularies[b]||{};for(var d in a)a.hasOwnProperty(d)&&(this.vocabularies[b][d]=a[d]);return this}},{key:"load",value:function(a){var b=this,c=arguments.length<=1||void 0===arguments[1]?null:arguments[1],d=this.options;c=c||d.filename;var e=d.path+"/"+a+"/"+c+".json";return g.get(e).then(function(c){return b.addResources(c,a),Promise.resolve(c)})}},{key:"translate",value:function(a){var b=this.options,e=b.defaultLang,f=void 0;if(a&&(this.vocabularies[e]&&this.vocabularies[e]&&(f=c(this.vocabularies[e],a)),!f&&b.fallbackLang&&this.vocabularies[b.fallbackLang]&&(f=c(this.vocabularies[b.fallbackLang],a))),f){for(var g=arguments.length,h=Array(g>1?g-1:0),i=1;g>i;i++)h[i-1]=arguments[i];f=d.apply(void 0,[f].concat(h))}return f}}],[{key:"detect",value:function(){if("undefined"!=typeof navigator){var a=navigator.language||navigator.browserLanguage;return a.split("_").shift().split("-").shift().toLowerCase()}return null}}]),a}()),a("I18N",h)}}}),a.register("19",["3","4","18"],function(a,b){"use strict";var c,d,e,f;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a.I18N}],execute:function(){a("I18NHelper",f=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];c(this,a),this.i18n=new e(b)}return d(a,[{key:"translate",value:function(a){for(var b,c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];(b=this.i18n).translate.apply(b,[a].concat(d))}}]),a}()),a("I18NHelper",f)}}}),a.register("1a",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("CacheHelper",e=function(){function a(b){c(this,a),this.registration=b}return d(a,[{key:"add",value:function(a){var b=this;return this.registration.onReady().then(function(){return b.worker.postMessage({command:"add_to_cache",url:a}),Promise.resolve()})}},{key:"remove",value:function(a){var b=this;return this.registration.onReady().then(function(){return b.worker.postMessage({command:"remove_from_cache",url:a}),Promise.resolve()})}}]),a}()),a("CacheHelper",e)}}}),a.register("1b",["3","9","a","1a"],function(a,b){"use strict";var c,d,e,f,g;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a.CacheHelper}],execute:function(){a("CacheHelper",g=function(a){function b(){return c(this,b),d(this,Object.getPrototypeOf(b).apply(this,arguments))}return e(b,a),b}(f)),a("CacheHelper",g)}}}),a.register("1c",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("CssHelper",e=function(){function a(){c(this,a)}return d(a,null,[{key:"add",value:function(a){return new Promise(function(b){var c=document.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),document.head.appendChild(c),b(c)})}}]),a}()),a("CssHelper",e)}}}),a.register("1d",["3","4","9","a","1e"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a.ContentException}],execute:function(){a("ContentErrorException",h=function(a){function b(){return c(this,b),e(this,Object.getPrototypeOf(b).apply(this,arguments))}return f(b,a),d(b,[{key:"defaultMessage",get:function(){return"Content error"}}]),b}(g)),a("ContentErrorException",h)}}}),a.register("9",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b})}}}),a.register("a",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)})}}}),a.register("3",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")})}}}),a.register("4",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}())}}}),a.register("1f",["3","4"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]}],execute:function(){a("AppException",e=function(){function a(b,d){c(this,a);for(var e=arguments.length,f=Array(e>2?e-2:0),g=2;e>g;g++)f[g-2]=arguments[g];var h=new(Function.prototype.bind.apply(Error,[null].concat([b],f)));return"undefined"==typeof b?h.message=this.defaultMessage:b instanceof Error&&(d=b,h.message=this.defaultMessage),d&&(h.originalError=d,h.message=h.message+", from "+d.name+": "+d.message+"."),h.name=this.constructor.name,Object.setPrototypeOf(h,this.constructor.prototype),h}return d(a,[{key:"defaultMessage",get:function(){return"Generic app error"}}]),a}()),a("AppException",e)}}}),a.register("1e",["3","4","9","a","1f"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a.AppException}],execute:function(){a("ContentException",h=function(a){function b(){return c(this,b),e(this,Object.getPrototypeOf(b).apply(this,arguments))}return f(b,a),d(b,[{key:"defaultMessage",get:function(){return"Generic content error."}}]),b}(g)),a("ContentException",h)}}}),a.register("20",["3","4","9","a","1e"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]},function(a){g=a.ContentException}],execute:function(){a("ContentNotFoundException",h=function(a){function b(){return c(this,b),e(this,Object.getPrototypeOf(b).apply(this,arguments))}return f(b,a),d(b,[{key:"defaultMessage",get:function(){return"Content not found"}}]),b}(g)),a("ContentNotFoundException",h)}}}),a.register("21",["20","1f","1e","1d"],function(a,b){"use strict";return{setters:[function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)}],execute:function(){}}}),a.register("22",["3","4","5","10","12","13","14","16","17","19","21","1b","1c"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return{setters:[function(a){d=a["default"]},function(a){e=a["default"]},function(a){g=a.CallbackManager},function(a){c=a["default"]},function(a){f=a.Router},function(a){h=a.RegisterHelper},function(a){i=a.View},function(a){j=a.PagesHelper},function(a){k=a.ViewHelper},function(a){l=a.I18NHelper},function(a){o=a},function(a){m=a.CacheHelper},function(a){n=a.CssHelper}],execute:function(){p=new g,a("App",q=function(){function a(b){var c=this;d(this,a),this.handleExceptions(),b&&this.bindTo(b),this.i18n=new this.constructor.I18NHelper(this.i18nOptions),this.pagesDispatcher=new this.constructor.PagesHelper(this.element),this.serviceWorkerUrl&&(this.sw=new h(this.serviceWorkerUrl,this.serviceWorkerOptions),this.sw.register().then(function(){c.cache=new c.constructor.CacheHelper(c.sw)})),this.router=new f(this.routeOptions);for(var e in this.routeRoules)this.routeRoules.hasOwnProperty(e)&&"function"==typeof this[this.routeRoules[e]]&&this.router.on(e,this[this.routeRoules[e]].bind(this));this.debounce(function(){c.router.start()})}return e(a,[{key:"ready",value:function(){return Promise.resolve()}},{key:"bindTo",value:function(a){this.element=a}},{key:"route",value:function(a,b){var d=this,e=arguments.length<=2||void 0===arguments[2]?"":arguments[2];if(e=e.split("/"),a){var f=this.routeMap[a];if("undefined"!=typeof f){var g=function(){var a=new f(d);return{v:a.ready.then(function(){var f=void 0;if(b&&"function"==typeof a[b]){var g;f=(g=a[b]).call.apply(g,[a].concat(c(e)))}else f=a.exec.apply(a,[b].concat(c(e)));f.then(function(b){return d.dispatchView(a,b)},function(a){if(a instanceof Error)throw a})},function(a){throw new o.ContentErrorException(a)})}}();if("object"==typeof g)return g.v}}throw new o.ContentNotFoundException}},{key:"dispatchView",value:function(a,b){var c=this,d=this.constructor.View;return new Promise(function(e){var f=new d(a,b),g=c.currentPage;c.currentView=f,c.pagesDispatcher.add(f,!1).then(function(b){c.currentPage=b;var d=g?g.destroy():Promise.resolve();c.debounce(function(){d.then(function(){c.currentPage.show(!g),a.dispatchResolved&&a.dispatchResolved(),e()})})})})}},{key:"debounce",value:function(a){setTimeout(function(){a()},0)}},{key:"navigate",value:function(a){this.router.navigate(a)}},{key:"handleExceptions",value:function(){var a=this;window.onerror=function(b,c,d,e,f){return f instanceof o.AppException?a.handleException(f):!1}}},{key:"handleException",value:function(a){return a instanceof o.ContentNotFoundException?(this.notFound(),!0):a instanceof o.ContentErrorException?(this.error(),!0):!1}},{key:"notFound",value:function(){}},{key:"error",value:function(){}},{key:"backState",value:function(){this.router.back()}},{key:"defaultRouteOptions",get:function(){return{dispatch:!0}}},{key:"routeOptions",get:function(){return this.defaultRouteOptions}},{key:"routeRoules",get:function(){return{"/*/*/..":"route","/*/*":"route","..":"route"}}},{key:"routeMap",get:function(){return{}}},{key:"i18nOptions",get:function(){return{languages:[]}}}],[{key:"addStyle",value:function(a){n.add(a)}},{key:"View",get:function(){return i}},{key:"ViewHelper",get:function(){return k}},{key:"PagesHelper",get:function(){return j}},{key:"I18NHelper",get:function(){return l}},{key:"CacheHelper",get:function(){return m}}]),a}()),a("App",q),p.attachToPrototype(q.prototype)}}}),a.register("1",["2","6","8","14","15","16","17","19","21","22","c","1b","1c","e","f"],function(a,b){"use strict";return{setters:[function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)},function(b){var c={};for(var d in b)"default"!==d&&(c[d]=b[d]);a(c)}],execute:function(){}}})})(function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof module&&module.exports&&"function"==typeof require?module.exports=a():Synapse=a()});
//# sourceMappingURL=synapse.js.map